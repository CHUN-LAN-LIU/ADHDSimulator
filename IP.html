<!-- IP InitiationParalysis ä»»åŠ¡å¯åŠ¨å›°éš¾ -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»»åŠ¡å¯åŠ¨å›°éš¾ - é‡åŠ›äº•ä¸æ’æ–¥åœº</title>
    <style>
        /* åŸºç¡€å¸ƒå±€ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        body {
            background: #f0f0f0;
            overflow: hidden; 
            height: 100vh;
            position: relative;
            cursor: default; /* é»˜è®¤ä½¿ç”¨ç³»ç»Ÿå…‰æ ‡ */
        }
        /* è‡ªå®šä¹‰é˜»åŠ›å…‰æ ‡ */
        .custom-cursor {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #666;
            pointer-events: none; /* ä¸é˜»æŒ¡ç‚¹å‡»äº‹ä»¶ */
            z-index: 9999;
            transition: transform 0.1s ease;
            display: none; /* åˆå§‹éšè—ï¼Œåªåœ¨é”å®šåæ˜¾ç¤º */
        }
        /* é¼ æ ‡é”å®šçŠ¶æ€æ—¶çš„å…‰æ ‡æ ·å¼ */
        body.pointer-locked {
            cursor: none !important;
        }
        body.pointer-locked .custom-cursor {
            display: block;
        }
        /* æ ¸å¿ƒå·¥ä½œåŒºï¼šåœ†å½¢é‡åŠ›äº• */
        .gravity-well {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: 
                radial-gradient(
                    circle at center,
                    rgba(200, 200, 255, 0.1) 0%,
                    rgba(150, 150, 255, 0.05) 30%,
                    rgba(100, 100, 255, 0.02) 60%,
                    transparent 70%
                );
        }
        /* ä»»åŠ¡æŒ‰é’® - 59pxå¤§å° */
        .task-button-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 59px;
            height: 59px;
            border-radius: 50%;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .task-btn {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                radial-gradient(
                    circle at center,
                    #333 0%,
                    #222 100%
                );
            color: #fff;
            border: none;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s ease, background 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 
                0 0 15px rgba(0, 0, 0, 0.6),
                inset 0 0 8px rgba(255, 255, 255, 0.15);
            z-index: 2;
        }
        .task-btn:hover {
            transform: scale(1.05);
        }
        .task-btn::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 70%;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                rgba(255, 255, 255, 0.25) 0%,
                rgba(255, 255, 255, 0.1) 50%,
                transparent 70%
            );
            pointer-events: none;
        }
        .task-btn-text {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 8px;
        }
        .task-btn-title {
            font-size: 14px;
            margin-bottom: 2px;
            color: #fff;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
            white-space: nowrap;
        }
        .task-btn-subtitle {
            font-size: 8px;
            color: #ccc;
            white-space: nowrap;
        }
        /* æŒ‰é’®å‘¨å›´çš„é«˜é˜»åŠ›å…‰ç¯ */
        .button-halo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                rgba(255, 100, 100, 0.25) 0%,
                rgba(255, 100, 100, 0.15) 30%,
                transparent 70%
            );
            pointer-events: none;
            z-index: 3;
            animation: halo-pulse 1.5s infinite alternate;
        }
        @keyframes halo-pulse {
            0% { opacity: 0.15; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1.1); }
        }
        /* è¾¹ç¼˜å¨±ä¹åŒºï¼šGIFå®¹å™¨ - å¢å¼ºå¹¿å‘Šæ•ˆæœ */
        .entertainment-zones {
            position: absolute;
            width: 180px;
            height: 220px;
            border-radius: 12px;
            overflow: hidden;
            z-index: 10;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 3px solid #FF9800;
            animation: ad-pulse 2s infinite;
        }
        @keyframes ad-pulse {
            0%, 100% { 
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 8px 35px rgba(255, 152, 0, 0.6);
                transform: scale(1.02);
            }
        }
        .zone-1 {
            top: 40px;
            left: 40px;
        }
        .zone-2 {
            bottom: 40px;
            right: 40px;
        }
        .entertainment-gif {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #333; /* æ·»åŠ èƒŒæ™¯è‰²ä»¥é˜²å›¾ç‰‡åŠ è½½å¤±è´¥ */
        }
        /* å¹¿å‘Šæ ‡ç­¾ */
        .ad-label {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #FF9800;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 11;
            box-shadow: 0 3px 10px rgba(255, 152, 0, 0.5);
        }
        .zone-1 .ad-label {
            background: #2196F3;
            box-shadow: 0 3px 10px rgba(33, 150, 243, 0.5);
        }
        .zone-2 .ad-label {
            background: #E91E63;
            box-shadow: 0 3px 10px rgba(233, 30, 99, 0.5);
        }
        /* èƒ½é‡æ¡ - åŠ é•¿ç‰ˆæœ¬ */
        .energy-bar {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 1000px;
            height: 30px;
            background: #eee;
            border-radius: 15px;
            overflow: hidden;
            display: block;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border: 3px solid #ddd;
        }
        .energy-fill {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, 
                #4CAF50 0%, 
                #8BC34A 25%, 
                #FFC107 50%, 
                #FF9800 75%, 
                #F44336 100%);
            transition: width 0.05s linear;
            position: relative;
        }
        .energy-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.4), 
                transparent);
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        /* èƒ½é‡æ•°å€¼æ˜¾ç¤º */
        .energy-value {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        /* è¯Šæ–­å›¾å±‚ */
        .diagnosis-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            color: #fff;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 50px;
            z-index: 999;
            filter: grayscale(1);
            background-image: linear-gradient(transparent 50%, rgba(255,0,0,0.2) 50%);
            background-size: 100% 4px;
            animation: scanline 0.1s linear infinite;
        }
        @keyframes scanline {
            0% { background-position: 0 0; }
            100% { background-position: 0 10px; }
        }
        .diagnosis-content {
            max-width: 800px;
            line-height: 1.8;
        }
        /* å¬è§‰åé¦ˆæç¤º */
        .audio-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #666;
            font-size: 14px;
        }
        /* é¼ æ ‡é”å®šæç¤º */
        .lock-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 18px;
            z-index: 1000;
            background: rgba(255,255,255,0.8);
            padding: 20px 40px;
            border-radius: 8px;
            transition: opacity 0.3s ease;
            text-align: center;
        }
        .lock-hint.hidden {
            opacity: 0;
            pointer-events: none;
        }
        /* å£°éŸ³æ§åˆ¶æŒ‰é’® */
        .audio-control {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        .audio-control:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        /* è®¡æ—¶å™¨æ˜¾ç¤º */
        .timer-display {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
            color: #333;
            background: rgba(255,255,255,0.8);
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        /* é˜»åŠ›æŒ‡ç¤ºå™¨ */
        .resistance-indicator {
            position: absolute;
            top: 110px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: #666;
            background: rgba(255,255,255,0.8);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
        }
        /* æŒ‰é’®æç¤º - ç½‘é¡µä¸‹æ–¹ï¼ˆç®€åŒ–ç‰ˆï¼‰ */
        .button-instruction {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 18px;
            color: #333;
            text-align: center;
            z-index: 100;
        }
        /* å¾®å°æŒ‰é’®å¯»æ‰¾æç¤º */
        .find-button-hint {
            position: absolute;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #999;
            background: rgba(255,255,255,0.6);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
            font-style: italic;
        }
        /* åˆ†å¿ƒå€’è®¡æ—¶æç¤º - æ”¹ä¸º1ç§’ */
        .distraction-timer {
            position: absolute;
            top: 180px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #FF9800;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            display: none;
            box-shadow: 0 3px 10px rgba(255, 152, 0, 0.3);
        }
    </style>
</head>
<body>
    <!-- å£°éŸ³æ§åˆ¶æŒ‰é’® -->
    <button class="audio-control" id="audioControl">ğŸ”Š å¼€å¯å£°éŸ³</button>
    
    <!-- è‡ªå®šä¹‰é˜»åŠ›å…‰æ ‡ -->
    <div class="custom-cursor" id="customCursor"></div>
    <!-- é¼ æ ‡é”å®šæç¤º -->
    <div class="lock-hint" id="lockHint">ç‚¹å‡»é¡µé¢å¼€å§‹ä½“éªŒï¼ŒæŒ‰Escé€€å‡ºä½“éªŒ</div>

    <!-- æ ¸å¿ƒå·¥ä½œåŒº -->
    <div class="gravity-well" id="gravityWell">
        <!-- æŒ‰é’®å‘¨å›´çš„å…‰ç¯ -->
        <div class="button-halo" id="buttonHalo"></div>
        
        <!-- ä»»åŠ¡æŒ‰é’® -->
        <div class="task-button-container" id="taskButtonContainer">
            <button class="task-btn" id="taskBtn">
                <div class="task-btn-text">
                    <div class="task-btn-title">å¼€å§‹å·¥ä½œ</div>
                    <div class="task-btn-subtitle">å­£åº¦æŠ¥å‘Š</div>
                </div>
            </button>
        </div>
    </div>

    <!-- è¾¹ç¼˜å¨±ä¹åŒº/å¹¿å‘ŠåŒº -->
    <div class="entertainment-zones zone-1" id="zone1">
        <div class="ad-label">æç¬‘è§†é¢‘</div>
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExeHF4OWV2bTV2Mnd0OW96a2w4aGJmOWE4OWY2bWg4N2U1YzA1ZiZlcD12MV9pbnRlcm5hbF9naWZzX2dpZklkJmN0PWc/JIX9t2j0ZTN9S/giphy.gif" alt="çŒ«å’ªä¿ƒé”€" class="entertainment-gif">
    </div>
    <div class="entertainment-zones zone-2" id="zone2">
        <div class="ad-label">å›¢è´­ä¿ƒé”€</div>
        <img src="https://picsum.photos/181/221?random=2" alt="çƒ­é—¨æ¸¸æˆ" class="entertainment-gif">
    </div>

    <!-- èƒ½é‡æ¡ -->
    <div class="energy-bar" id="energyBar">
        <div class="energy-fill" id="energyFill"></div>
    </div>
    
    <!-- èƒ½é‡æ•°å€¼æ˜¾ç¤º -->
    <div class="energy-value" id="energyValue">100%</div>
    
    <!-- è®¡æ—¶å™¨æ˜¾ç¤º -->
    <div class="timer-display" id="timerDisplay">å°è¯•æ—¶é—´: 0.0ç§’</div>
    
    <!-- é˜»åŠ›æŒ‡ç¤ºå™¨ -->
    <div class="resistance-indicator" id="resistanceIndicator">å½“å‰é˜»åŠ›: 0%</div>
    
    <!-- å¾®å°æŒ‰é’®å¯»æ‰¾æç¤º -->
    <div class="find-button-hint" id="findButtonHint"></div>
    
    <!-- åˆ†å¿ƒå€’è®¡æ—¶æç¤º -->
    <div class="distraction-timer" id="distractionTimer">åˆ†å¿ƒå€’è®¡æ—¶: 1.0ç§’</div>
    
    <!-- æŒ‰é’®æç¤º - ç½‘é¡µä¸‹æ–¹ï¼ˆç®€åŒ–ç‰ˆï¼‰ -->
    <div class="button-instruction">æŒ‰ä¸‹æŒ‰é’®å¼€å§‹ä¸‹ä¸€æ­¥</div>

    <!-- è¯Šæ–­å›¾å±‚ -->
    <div class="diagnosis-overlay" id="diagnosisOverlay">
        <div class="diagnosis-content">
            <h2>ç¥ç»ç—…ç†å­¦è¯Šæ–­ï¼šå¯åŠ¨ç³»ç»Ÿç˜«ç—ªï¼ˆInitiation Paralysisï¼‰</h2>
            <h3>ã€æ£€æµ‹åˆ°æ„æ„¿ä¸è¡ŒåŠ¨æ–­è£‚ã€‘</h3>
            <p>ä¸ºä»€ä¹ˆä½ ç‚¹ä¸åˆ°é‚£ä¸ªæŒ‰é’®ï¼Ÿä½ åˆšæ‰çš„ä½“éªŒï¼Œç²¾å‡†å¤åˆ»äº†ADHDæ‚£è€…é¢å¯¹"æ¯ç‡¥ä»»åŠ¡"æ—¶çš„å¤§è„‘é£æš´ï¼š</p>
            <ol>
                <li><strong>å¤šå·´èƒºèµ¤å­—ï¼ˆDopamine Deficitï¼‰</strong>ï¼šé‚£ä¸ªåƒèƒ¶æ°´ä¸€æ ·çš„è¿Ÿæ»æ„Ÿï¼Œæ¨¡æ‹Ÿäº†å¤§è„‘ç¼ºä¹å¤šå·´èƒºçš„çŠ¶æ€ã€‚å¤šå·´èƒºæ˜¯è¡ŒåŠ¨çš„"ç‡ƒæ–™"ï¼Œæ²¡æœ‰å®ƒï¼Œå³ä½¿ä½ æƒ³åšï¼Œå¤§è„‘çš„ç‚¹ç«å™¨ä¹Ÿæ‰“ä¸ç€ç«ã€‚</li>
                <li><strong>å‰è„‘å²›æ¿€æ´»ï¼ˆInsula Activationï¼‰</strong>ï¼šå½“ä½ é è¿‘æŒ‰é’®æ—¶æ„Ÿå—åˆ°çš„"æ–¥åŠ›"å’Œ"ç„¦è™‘"ï¼Œæ˜¯å› ä¸ºADHDæ‚£è€…çš„å¤§è„‘å‰è„‘å²›åŒºåŸŸè¿‡åº¦æ¿€æ´»ã€‚å®ƒå°†"å†™æŠ¥å‘Š"è¿™ç§æ— èŠä»»åŠ¡è¯†åˆ«ä¸º"ç‰©ç†ç–¼ç—›"ï¼Œå¹¶ä¸‹è¾¾äº†"æ’¤é€€"çš„ç”Ÿç†æŒ‡ä»¤ã€‚</li>
                <li><strong>æ„å‘æ€§å¤±æ•ˆ</strong>ï¼šä½ åˆšæ‰æ˜¯ä¸æ˜¯æ¾äº†ä¸€å£æ°”ï¼Œå…‰æ ‡å°±é£å‡ºå»äº†ï¼Ÿè¿™å«æ„å‘æ€§å¤±æ•ˆã€‚ä½ çš„å‰é¢å¶çš®å±‚æ— æ³•ç»´æŒæŒç»­çš„è¡ŒåŠ¨æŒ‡ä»¤ï¼Œæ³¨æ„åŠ›åƒæ°´ä¸€æ ·æµå‘äº†é˜»åŠ›æœ€å°ï¼ˆæœ€å¥½ç©ï¼‰çš„åœ°æ–¹ã€‚</li>
            </ol>
            <p><strong>ç»“è®º</strong>ï¼šADHDçš„æ‹–å»¶ä¸æ˜¯"æˆ‘é€‰æ‹©ä¸åš"ï¼Œè€Œæ˜¯"æˆ‘æ‹¼å‘½è¸©æ²¹é—¨ï¼Œä½†å¼•æ“æ²¡æœ‰è¿æ¥åˆ°è½®å­ä¸Š"ã€‚</p>
        </div>
    </div>

    <!-- å¬è§‰åé¦ˆæç¤º -->
    <div class="audio-hint">æç¤ºï¼šå¼€å¯å£°éŸ³ä½“éªŒè€³é¸£æ•ˆæœ</div>

    <script>
        // æ ¸å¿ƒå…ƒç´ è·å–
        const gravityWell = document.getElementById('gravityWell');
        const taskBtn = document.getElementById('taskBtn');
        const taskButtonContainer = document.getElementById('taskButtonContainer');
        const buttonHalo = document.getElementById('buttonHalo');
        const zone1 = document.getElementById('zone1');
        const zone2 = document.getElementById('zone2');
        const energyBar = document.getElementById('energyBar');
        const energyFill = document.getElementById('energyFill');
        const energyValue = document.getElementById('energyValue');
        const diagnosisOverlay = document.getElementById('diagnosisOverlay');
        const customCursor = document.getElementById('customCursor');
        const lockHint = document.getElementById('lockHint');
        const audioControl = document.getElementById('audioControl');
        const timerDisplay = document.getElementById('timerDisplay');
        const resistanceIndicator = document.getElementById('resistanceIndicator');
        const findButtonHint = document.getElementById('findButtonHint');
        const distractionTimer = document.getElementById('distractionTimer');
        const buttonInstruction = document.querySelector('.button-instruction');
        const body = document.body;
        
        // ========== Web Audio API éŸ³é¢‘ç³»ç»Ÿ ==========
        let audioContext;
        let oscillator;
        let gainNode;
        let noiseGainNode;
        let noiseNode;
        let filterNode;
        let isAudioEnabled = false;
        let isPlaying = false;
        
        // åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            // åˆ›å»ºä½é¢‘æŒ¯è¡å™¨ï¼ˆç”µæµå£°åŸºç¡€ï¼‰
            oscillator = audioContext.createOscillator();
            oscillator.type = 'sawtooth'; // é”¯é½¿æ³¢äº§ç”Ÿç±»ä¼¼ç”µæµçš„å£°éŸ³
            oscillator.frequency.value = 60; // 60Hzä½é¢‘ï¼Œç±»ä¼¼ç”µæµå£°
            
            // åˆ›å»ºç™½å™ªå£°æºï¼ˆç”¨äºè€³é¸£æ•ˆæœï¼‰
            noiseNode = audioContext.createBufferSource();
            const bufferSize = audioContext.sampleRate * 2;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const output = buffer.getChannelData(0);
            
            // å¡«å……ç™½å™ªå£°
            for (let i = 0; i < bufferSize; i++) {
                output[i] = Math.random() * 2 - 1;
            }
            
            noiseNode.buffer = buffer;
            noiseNode.loop = true;
            
            // åˆ›å»ºæ»¤æ³¢å™¨ï¼ˆæ¨¡æ‹Ÿè€³é¸£çš„é«˜é¢‘ç‰¹æ€§ï¼‰
            filterNode = audioContext.createBiquadFilter();
            filterNode.type = 'bandpass';
            filterNode.frequency.value = 8000; // é«˜é¢‘è€³é¸£
            filterNode.Q.value = 1;
            
            // åˆ›å»ºå¢ç›ŠèŠ‚ç‚¹æ§åˆ¶éŸ³é‡
            gainNode = audioContext.createGain();
            gainNode.gain.value = 0; // åˆå§‹éŸ³é‡ä¸º0
            
            // åˆ›å»ºå™ªå£°å¢ç›ŠèŠ‚ç‚¹
            noiseGainNode = audioContext.createGain();
            noiseGainNode.gain.value = 0;
            
            // è¿æ¥èŠ‚ç‚¹
            oscillator.connect(gainNode);
            noiseNode.connect(filterNode);
            filterNode.connect(noiseGainNode);
            gainNode.connect(audioContext.destination);
            noiseGainNode.connect(audioContext.destination);
            
            // å¯åŠ¨æŒ¯è¡å™¨å’Œå™ªå£°
            oscillator.start();
            noiseNode.start();
            
            isAudioEnabled = true;
            audioControl.textContent = "ğŸ”Š å…³é—­å£°éŸ³";
        }
        
        // æ’­æ”¾ç”µæµå£°
        function playCurrentSound(intensity = 0.3) {
            if (!isAudioEnabled || !audioContext || audioContext.state === 'suspended') {
                return;
            }
            
            // æ ¹æ®å¼ºåº¦è°ƒæ•´å£°éŸ³å‚æ•°
            const baseFreq = 60 + (intensity * 40); // é¢‘ç‡éšå¼ºåº¦å˜åŒ–
            const volume = Math.min(0.5, intensity * 0.8); // éŸ³é‡éšå¼ºåº¦å˜åŒ–
            const noiseVolume = Math.min(0.2, intensity * 0.3); // å™ªå£°éŸ³é‡
            
            // ä½¿ç”¨æŒ‡æ•°å˜åŒ–ä½¿è¿‡æ¸¡æ›´å¹³æ»‘
            oscillator.frequency.exponentialRampToValueAtTime(
                baseFreq, 
                audioContext.currentTime + 0.1
            );
            
            gainNode.gain.exponentialRampToValueAtTime(
                volume, 
                audioContext.currentTime + 0.1
            );
            
            noiseGainNode.gain.exponentialRampToValueAtTime(
                noiseVolume, 
                audioContext.currentTime + 0.1
            );
            
            // éšæœºè°ƒåˆ¶æ»¤æ³¢å™¨é¢‘ç‡æ¨¡æ‹Ÿè€³é¸£å˜åŒ–
            filterNode.frequency.setValueAtTime(
                7000 + Math.random() * 2000, 
                audioContext.currentTime
            );
            
            isPlaying = true;
        }
        
        // åœæ­¢ç”µæµå£°
        function stopCurrentSound() {
            if (!isAudioEnabled || !audioContext) return;
            
            // å¹³æ»‘æ·¡å‡º
            gainNode.gain.exponentialRampToValueAtTime(
                0.001, 
                audioContext.currentTime + 0.5
            );
            
            noiseGainNode.gain.exponentialRampToValueAtTime(
                0.001, 
                audioContext.currentTime + 0.5
            );
            
            isPlaying = false;
        }
        
        // åˆ‡æ¢éŸ³é¢‘çŠ¶æ€
        function toggleAudio() {
            if (!isAudioEnabled) {
                initAudio();
                // ç”¨æˆ·äº¤äº’åæ¢å¤éŸ³é¢‘ä¸Šä¸‹æ–‡
                if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
            } else {
                if (audioContext) {
                    audioContext.suspend();
                    isAudioEnabled = false;
                    audioControl.textContent = "ğŸ”‡ å¼€å¯å£°éŸ³";
                }
            }
        }
        
        // éŸ³é¢‘æ§åˆ¶æŒ‰é’®äº‹ä»¶
        audioControl.addEventListener('click', () => {
            toggleAudio();
        });
        
        // é¡µé¢ç‚¹å‡»æ—¶åˆå§‹åŒ–éŸ³é¢‘ï¼ˆéµå¾ªæµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥ï¼‰
        document.addEventListener('click', () => {
            if (!audioContext && isAudioEnabled) {
                initAudio();
            }
        });
        
        // ========== çŠ¶æ€å˜é‡ ==========
        const GRAVITY_WELL_RADIUS = 200; // é‡åŠ›äº•åŠå¾„
        const BUTTON_RADIUS = 29.5; // æŒ‰é’®åŠå¾„ï¼ˆ59pxç›´å¾„çš„ä¸€åŠï¼‰
        const HALO_RADIUS = 50; // å…‰ç¯åŠå¾„
        const CORE_RADIUS = 80; // æ ¸å¿ƒé˜»åŠ›åŒºåŸŸåŠå¾„
        const MIDDLE_RADIUS = 140; // ä¸­ç­‰é˜»åŠ›åŒºåŸŸåŠå¾„
        const OUTER_RADIUS = 190; // å¤–å±‚é˜»åŠ›åŒºåŸŸåŠå¾„
        const DISTRACTION_TIMEOUT = 1000; // 1ç§’åˆ†å¿ƒå€’è®¡æ—¶
        
        let mousePos = { x: window.innerWidth/2, y: window.innerHeight/2 };
        let isLocked = false;
        let isNearButton = false;
        let isInCoreZone = false;
        let energy = 100;
        let failCount = 0;
        let isFrozen = false;
        let isInsideGravityWell = false;
        let startTime = 0;
        let attemptTimer = 0;
        let timerInterval = null;
        let energyDepletionStartTime = 0;
        let timeNearButton = 0;
        let currentResistance = 0;
        let buttonFound = false;
        
        // åˆ†å¿ƒå€’è®¡æ—¶ç›¸å…³å˜é‡
        let lastMouseMoveTime = 0;
        let distractionTimerInterval = null;
        let distractionCountdown = 1.0; // 1.0ç§’
        let isDistractionActive = false;

        // é‡åŠ›äº•ä¸­å¿ƒä½ç½®è®¡ç®—
        const gravityWellRect = gravityWell.getBoundingClientRect();
        const gravityWellCenter = {
            x: gravityWellRect.left + gravityWellRect.width / 2,
            y: gravityWellRect.top + gravityWellRect.height / 2
        };

        // è·å–å¹¿å‘ŠåŒºåŸŸä½ç½®
        const zone1Rect = zone1.getBoundingClientRect();
        const zone2Rect = zone2.getBoundingClientRect();
        const zone1Center = {
            x: zone1Rect.left + zone1Rect.width / 2,
            y: zone1Rect.top + zone1Rect.height / 2
        };
        const zone2Center = {
            x: zone2Rect.left + zone2Rect.width / 2,
            y: zone2Rect.top + zone2Rect.height / 2
        };

        // ========== è®¡æ—¶å™¨åŠŸèƒ½ ==========
        function startTimer() {
            startTime = Date.now();
            energyDepletionStartTime = 0;
            timeNearButton = 0;
            lastMouseMoveTime = Date.now(); // åˆå§‹åŒ–æœ€åç§»åŠ¨æ—¶é—´
            
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                attemptTimer = (Date.now() - startTime) / 1000;
                timerDisplay.textContent = `å°è¯•æ—¶é—´: ${attemptTimer.toFixed(1)}ç§’`;
                
                // æ›´æ–°é˜»åŠ›æŒ‡ç¤ºå™¨
                resistanceIndicator.textContent = `å½“å‰é˜»åŠ›: ${Math.round(currentResistance * 100)}%`;
                if (currentResistance > 0.9) {
                    resistanceIndicator.style.color = '#F44336';
                    resistanceIndicator.style.fontWeight = 'bold';
                } else if (currentResistance > 0.6) {
                    resistanceIndicator.style.color = '#FF9800';
                } else {
                    resistanceIndicator.style.color = '#666';
                }
                
                // æ›´æ–°å¯»æ‰¾æŒ‰é’®æç¤º - ä¿®æ”¹ä¸ºæ›´ç®€æ´çš„æç¤º
                if (buttonFound) {
                    findButtonHint.textContent = "å·²æ‰¾åˆ°æŒ‰é’®ï¼ä¿æŒç¨³å®šç‚¹å‡»...";
                    findButtonHint.style.color = "#4CAF50";
                    findButtonHint.style.fontWeight = "bold";
                } else if (isNearButton) {
                    findButtonHint.textContent = "æ¥è¿‘æŒ‰é’®ä¸­...ä¿æŒç¨³å®š";
                    findButtonHint.style.color = "#FF9800";
                } else {
                    findButtonHint.textContent = ""; // æ¸…ç©ºæç¤º
                }
            }, 100);
            
            // å¯åŠ¨åˆ†å¿ƒå€’è®¡æ—¶æ£€æµ‹
            startDistractionDetection();
        }
        
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            stopDistractionDetection();
        }

        // ========== åˆ†å¿ƒå€’è®¡æ—¶åŠŸèƒ½ ==========
        function startDistractionDetection() {
            if (distractionTimerInterval) clearInterval(distractionTimerInterval);
            
            distractionTimerInterval = setInterval(() => {
                const currentTime = Date.now();
                const timeSinceLastMove = currentTime - lastMouseMoveTime;
                
                // è®¡ç®—å‰©ä½™æ—¶é—´ï¼ˆ1ç§’ï¼‰
                distractionCountdown = Math.max(0, (DISTRACTION_TIMEOUT - timeSinceLastMove) / 1000);
                
                // æ›´æ–°å€’è®¡æ—¶æ˜¾ç¤º - 0.5ç§’åå¼€å§‹æ˜¾ç¤º
                if (timeSinceLastMove > 500) { // 0.5ç§’åå¼€å§‹æ˜¾ç¤º
                    distractionTimer.style.display = 'block';
                    distractionTimer.textContent = `åˆ†å¿ƒå€’è®¡æ—¶: ${distractionCountdown.toFixed(1)}ç§’`;
                    
                    // é¢œè‰²å˜åŒ– - è°ƒæ•´æ—¶é—´é˜ˆå€¼
                    if (distractionCountdown < 0.3) { // æœ€å0.3ç§’å˜çº¢
                        distractionTimer.style.color = '#F44336';
                        distractionTimer.style.background = 'rgba(255, 255, 255, 0.95)';
                    } else if (distractionCountdown < 0.7) { // 0.3-0.7ç§’å˜é»„
                        distractionTimer.style.color = '#FF9800';
                        distractionTimer.style.background = 'rgba(255, 255, 255, 0.9)';
                    } else { // 0.7-1.0ç§’å˜ç»¿
                        distractionTimer.style.color = '#4CAF50';
                        distractionTimer.style.background = 'rgba(255, 255, 255, 0.8)';
                    }
                } else {
                    distractionTimer.style.display = 'none';
                }
                
                // å¦‚æœ1ç§’æ²¡æœ‰ç§»åŠ¨ï¼Œè§¦å‘åˆ†å¿ƒ
                if (timeSinceLastMove >= DISTRACTION_TIMEOUT && !isDistractionActive && isLocked && !isFrozen) {
                    triggerDistraction();
                }
            }, 50); // åŠ å¿«æ£€æµ‹é¢‘ç‡åˆ°50ms
        }
        
        function stopDistractionDetection() {
            if (distractionTimerInterval) {
                clearInterval(distractionTimerInterval);
                distractionTimerInterval = null;
            }
            distractionTimer.style.display = 'none';
        }
        
        function updateMouseMoveTime() {
            lastMouseMoveTime = Date.now();
            isDistractionActive = false;
        }
        
        function triggerDistraction() {
            isDistractionActive = true;
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªå¹¿å‘ŠåŒºåŸŸ
            const randomZone = Math.random() > 0.5 ? zone1Center : zone2Center;
            const targetX = randomZone.x;
            const targetY = randomZone.y;
            
            // æ’­æ”¾åˆ†å¿ƒéŸ³æ•ˆ - æ›´æ€¥ä¿ƒçš„éŸ³æ•ˆ
            if (isAudioEnabled && audioContext) {
                const distractionSound = audioContext.createOscillator();
                const distractionGain = audioContext.createGain();
                
                distractionSound.type = 'triangle';
                distractionSound.frequency.setValueAtTime(400, audioContext.currentTime); // æ›´é«˜é¢‘ç‡
                distractionSound.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.2); // æ›´å¿«ä¸Šå‡
                
                distractionGain.gain.setValueAtTime(0.3, audioContext.currentTime); // æ›´å¤§éŸ³é‡
                distractionGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3); // æ›´å¿«æ·¡å‡º
                
                distractionSound.connect(distractionGain);
                distractionGain.connect(audioContext.destination);
                
                distractionSound.start();
                distractionSound.stop(audioContext.currentTime + 0.3);
            }
            
            // æ·»åŠ åˆ†å¿ƒæç¤º
            const distractionHint = document.createElement('div');
            distractionHint.textContent = "æ³¨æ„åŠ›å¿«é€Ÿåˆ†æ•£ï¼";
            distractionHint.style.position = 'absolute';
            distractionHint.style.top = '200px';
            distractionHint.style.left = '50%';
            distractionHint.style.transform = 'translateX(-50%)';
            distractionHint.style.color = '#FF5722';
            distractionHint.style.fontSize = '14px';
            distractionHint.style.fontWeight = 'bold';
            distractionHint.style.background = 'rgba(255, 255, 255, 0.95)';
            distractionHint.style.padding = '8px 15px';
            distractionHint.style.borderRadius = '8px';
            distractionHint.style.zIndex = '1001';
            distractionHint.style.boxShadow = '0 3px 15px rgba(255, 87, 34, 0.6)';
            body.appendChild(distractionHint);
            
            // å¿«é€Ÿç§»åŠ¨åˆ°å¹¿å‘ŠåŒºåŸŸï¼ˆæ›´å¿«ï¼‰
            const startX = mousePos.x;
            const startY = mousePos.y;
            
            // ç›´æ¥è·³åˆ°å¹¿å‘Šä½ç½®ï¼ˆæ›´çªç„¶ï¼‰
            mousePos.x = targetX;
            mousePos.y = targetY;
            customCursor.style.left = `${mousePos.x - 10}px`;
            customCursor.style.top = `${mousePos.y - 10}px`;
            
            // æ·»åŠ è§†è§‰åé¦ˆ
            customCursor.style.transform = 'scale(1.3)';
            customCursor.style.background = '#FF5722';
            
            // å¿«é€ŸåŠ¨ç”»æ•ˆæœ
            setTimeout(() => {
                customCursor.style.transform = 'scale(1)';
                customCursor.style.background = '#666';
                body.removeChild(distractionHint);
                updateMouseMoveTime(); // é‡ç½®å€’è®¡æ—¶
            }, 300); // 0.3ç§’åæ¢å¤
            
            // ä¸´æ—¶å¢åŠ å¹¿å‘ŠåŒºåŸŸçš„å¸å¼•åŠ›
            const selectedZone = randomZone === zone1Center ? zone1 : zone2;
            selectedZone.style.boxShadow = '0 8px 40px rgba(255, 87, 34, 0.9)';
            selectedZone.style.transform = 'scale(1.15)';
            selectedZone.style.borderColor = '#FF5722';
            
            setTimeout(() => {
                selectedZone.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.4)';
                selectedZone.style.transform = 'scale(1)';
                selectedZone.style.borderColor = '#FF9800';
            }, 800);
        }

        // ========== Pointer Lock API æ ¸å¿ƒé€»è¾‘ ==========
        // é”å®šé¼ æ ‡
        document.addEventListener('click', () => {
            if (!isLocked) {
                gravityWell.requestPointerLock = gravityWell.requestPointerLock || gravityWell.mozRequestPointerLock;
                gravityWell.requestPointerLock();
                body.classList.add('pointer-locked');
                
                // é¦–æ¬¡ç‚¹å‡»æ—¶åˆå§‹åŒ–éŸ³é¢‘
                if (!audioContext && isAudioEnabled) {
                    initAudio();
                }
                
                // å¼€å§‹è®¡æ—¶
                startTimer();
            }
        });

        // ç›‘å¬é¼ æ ‡é”å®šçŠ¶æ€å˜åŒ–
        document.addEventListener('pointerlockchange', lockChangeHandler, false);
        document.addEventListener('mozpointerlockchange', lockChangeHandler, false);

        function lockChangeHandler() {
            if (document.pointerLockElement === gravityWell || document.mozPointerLockElement === gravityWell) {
                // é¼ æ ‡å·²é”å®šï¼Œç›‘å¬ç›¸å¯¹ç§»åŠ¨äº‹ä»¶
                document.addEventListener('mousemove', handleMouseMove, false);
                isLocked = true;
                // éšè—ä¸­é—´æç¤º
                lockHint.classList.add('hidden');
            } else {
                // é¼ æ ‡è§£é”ï¼Œç§»é™¤ç›‘å¬
                document.removeEventListener('mousemove', handleMouseMove, false);
                body.classList.remove('pointer-locked');
                isLocked = false;
                lockHint.classList.remove('hidden');
                stopCurrentSound();
                stopTimer();
            }
        }

        // å¤„ç†é¼ æ ‡ç›¸å¯¹ç§»åŠ¨ï¼šåœ†å½¢é˜»åŠ›åœºè®¡ç®—
        function handleMouseMove(e) {
            if (isFrozen) return;
            
            // æ›´æ–°æœ€åç§»åŠ¨æ—¶é—´
            updateMouseMoveTime();

            // è®¡ç®—ç¦»é‡åŠ›äº•ä¸­å¿ƒçš„è·ç¦»
            const distanceToCenter = Math.hypot(mousePos.x - gravityWellCenter.x, mousePos.y - gravityWellCenter.y);
            
            // è®¡ç®—ç¦»æŒ‰é’®ä¸­å¿ƒçš„è·ç¦»
            const distanceToButton = Math.hypot(mousePos.x - gravityWellCenter.x, mousePos.y - gravityWellCenter.y);
            
            // åˆ¤æ–­æ˜¯å¦åœ¨é‡åŠ›äº•å†…
            isInsideGravityWell = distanceToCenter <= GRAVITY_WELL_RADIUS;
            
            // åˆ¤æ–­æ˜¯å¦æ¥è¿‘æŒ‰é’®
            isNearButton = distanceToButton <= HALO_RADIUS * 1.2;
            
            // æ ¹æ®åŒºåŸŸè®¡ç®—é˜»åŠ›ï¼ˆåœ†å½¢æ¢¯åº¦é˜»åŠ›ï¼‰
            let resistance = 0;
            let zoneType = 'outside';
            
            if (distanceToCenter <= CORE_RADIUS) {
                // æ ¸å¿ƒåŒºåŸŸï¼šæœ€å¤§é˜»åŠ›ï¼ˆå‡ ä¹æ— æ³•ç§»åŠ¨ï¼‰
                const normalized = distanceToCenter / CORE_RADIUS;
                resistance = 0.96 - (normalized * 0.08); // 96-88%é˜»åŠ›
                zoneType = 'core';
                isInCoreZone = true;
                
                // åœ¨æ ¸å¿ƒåŒºä½†æ¥è¿‘æŒ‰é’®æ—¶å¢åŠ è§†è§‰åé¦ˆ
                if (isNearButton) {
                    buttonFound = true;
                    // æŒ‰é’®å‘å…‰æ•ˆæœå¢å¼º
                    taskBtn.style.boxShadow = `0 0 25px rgba(255, 255, 100, 0.6), inset 0 0 12px rgba(255, 255, 255, 0.25)`;
                    buttonHalo.style.opacity = '0.4';
                }
            } else if (distanceToCenter <= MIDDLE_RADIUS) {
                // ä¸­é—´åŒºåŸŸï¼šé«˜é˜»åŠ›
                const normalized = (distanceToCenter - CORE_RADIUS) / (MIDDLE_RADIUS - CORE_RADIUS);
                resistance = 0.82 - (normalized * 0.32);
                zoneType = 'middle';
                isInCoreZone = false;
            } else if (distanceToCenter <= OUTER_RADIUS) {
                // å¤–å±‚åŒºåŸŸï¼šä¸­ç­‰é˜»åŠ›
                const normalized = (distanceToCenter - MIDDLE_RADIUS) / (OUTER_RADIUS - MIDDLE_RADIUS);
                resistance = 0.45 - (normalized * 0.25);
                zoneType = 'outer';
                isInCoreZone = false;
            } else if (distanceToCenter <= GRAVITY_WELL_RADIUS) {
                // è¾¹ç¼˜åŒºåŸŸï¼šè½»å¾®é˜»åŠ›
                const normalized = (distanceToCenter - OUTER_RADIUS) / (GRAVITY_WELL_RADIUS - OUTER_RADIUS);
                resistance = 0.18 - (normalized * 0.13);
                zoneType = 'edge';
                isInCoreZone = false;
            } else {
                // é‡åŠ›äº•å¤–ï¼šæ— é˜»åŠ›
                resistance = 0;
                zoneType = 'outside';
                isInCoreZone = false;
            }
            
            currentResistance = resistance;
            
            // åº”ç”¨é˜»åŠ›ï¼šé¼ æ ‡å®é™…ç§»åŠ¨è·ç¦» = åŸå§‹ç§»åŠ¨è·ç¦» Ã— (1 - é˜»åŠ›)
            const moveX = e.movementX * (1 - resistance);
            const moveY = e.movementY * (1 - resistance);

            // æ›´æ–°è‡ªå®šä¹‰å…‰æ ‡ä½ç½®
            mousePos.x += moveX;
            mousePos.y += moveY;
            customCursor.style.left = `${mousePos.x - 10}px`;
            customCursor.style.top = `${mousePos.y - 10}px`;

            // æ ¸å¿ƒåŒºåŸŸä¸”æ¥è¿‘æŒ‰é’®çš„åˆ¤å®š
            if (isInCoreZone && isNearButton) {
                // è®¡ç®—æ¥è¿‘å¼ºåº¦ï¼ˆåŸºäºè·ç¦»æŒ‰é’®çš„æ¯”ä¾‹ï¼‰
                const repulsionForce = 1 - (distanceToButton / (HALO_RADIUS * 1.2));
                
                // è®°å½•å¼€å§‹æ¶ˆè€—èƒ½é‡çš„æ—¶é—´
                if (energyDepletionStartTime === 0) {
                    energyDepletionStartTime = Date.now();
                }
                
                // ç´¯ç§¯åœ¨æŒ‰é’®é™„è¿‘çš„æ—¶é—´
                timeNearButton += 0.016;
                
                // æ’­æ”¾Web Audioç”Ÿæˆçš„ç”µæµå£°
                if (isAudioEnabled) {
                    playCurrentSound(repulsionForce);
                }
                
                // è§†è§‰åé¦ˆï¼šå…‰æ ‡å˜åŒ–
                customCursor.style.transform = `scale(${1 + repulsionForce * 2.2})`;
                customCursor.style.opacity = `${0.6 - repulsionForce * 0.3}`;
                customCursor.style.background = `rgb(${Math.floor(200 - repulsionForce * 80)}, ${Math.floor(160 - repulsionForce * 80)}, ${Math.floor(120 - repulsionForce * 50)})`;
                
                // å¢å¼ºçš„æŒ‰é’®æŠ–åŠ¨æ•ˆæœ - å¹…åº¦æ›´å¤§ï¼Œæ–¹å‘æ›´å¤š
                const shakeAmount = 60; // ä»35å¢åŠ åˆ°60ï¼Œå¤§å¹…å¢åŠ æŠ–åŠ¨å¹…åº¦
                const xShake = (Math.random() - 0.5) * 2 * shakeAmount * repulsionForce; // å¢åŠ éšæœºæ–¹å‘å˜åŒ–
                const yShake = (Math.random() - 0.5) * 2 * shakeAmount * repulsionForce;
                taskButtonContainer.style.transform = `translate(-50%, -50%) translate(${xShake}px, ${yShake}px)`;
                
                // å…‰ç¯å‘å…‰æ•ˆæœ
                buttonHalo.style.boxShadow = `0 0 ${12 + repulsionForce * 18}px rgba(255, 100, 100, ${0.3 + repulsionForce * 0.25})`;
                
                // è®¡ç®—èƒ½é‡æ¶ˆè€—
                const timeInZone = (Date.now() - energyDepletionStartTime) / 1000;
                const targetEnergy = Math.max(0, 100 - (timeInZone / 7) * 100); // 7ç§’è€—å°½
                const energyDiff = energy - targetEnergy;
                
                if (energyDiff > 0) {
                    reduceEnergy(energyDiff);
                }
                
                // å¢å¼ºçš„æ ¸å¿ƒåŒºåŸŸæ’æ–¥åŠ›ï¼ˆå‘å¤–æ¨ï¼‰ - æ·»åŠ æ›´å¤šæ–¹å‘çš„æ’æ–¥
                if (distanceToButton < BUTTON_RADIUS * 1.5) {
                    const pushForce = 0.25 + repulsionForce * 0.35; // å¢åŠ æ’æ–¥åŠ›
                    const angleToCenter = Math.atan2(mousePos.y - gravityWellCenter.y, mousePos.x - gravityWellCenter.x);
                    
                    // æ·»åŠ éšæœºè§’åº¦åç§»ï¼Œåˆ›é€ æ›´å¤šæ–¹å‘çš„æ’æ–¥
                    const randomAngleOffset = (Math.random() - 0.5) * 0.5; // éšæœºè§’åº¦åç§»
                    const finalAngle = angleToCenter + randomAngleOffset;
                    
                    // å‘å¤–æ¨ - å¢åŠ å¹…åº¦
                    mousePos.x += Math.cos(finalAngle) * pushForce * 35; // ä»25å¢åŠ åˆ°35
                    mousePos.y += Math.sin(finalAngle) * pushForce * 35; // ä»25å¢åŠ åˆ°35
                    
                    // æ·»åŠ é¢å¤–çš„éšæœºæ¨ªå‘æŠ–åŠ¨
                    mousePos.x += (Math.random() - 0.5) * pushForce * 15;
                    mousePos.y += (Math.random() - 0.5) * pushForce * 15;
                }
                
            } else {
                // é‡ç½®èƒ½é‡æ¶ˆè€—è®¡æ—¶
                energyDepletionStartTime = 0;
                buttonFound = false;
                
                // åœæ­¢ç”µæµå£°
                if (isAudioEnabled) {
                    stopCurrentSound();
                }
                
                // æ¢å¤å…‰æ ‡æ ·å¼
                customCursor.style.transform = 'scale(1)';
                customCursor.style.opacity = '1';
                customCursor.style.background = '#666';
                taskButtonContainer.style.transform = 'translate(-50%, -50%)';
                
                // æ¢å¤æŒ‰é’®æ ·å¼
                taskBtn.style.boxShadow = '0 0 15px rgba(0, 0, 0, 0.6), inset 0 0 8px rgba(255, 255, 255, 0.15)';
                buttonHalo.style.boxShadow = 'none';
                buttonHalo.style.opacity = '0.25';
                
                // èƒ½é‡æ¢å¤ï¼ˆæ ¹æ®åŒºåŸŸä¸åŒæ¢å¤é€Ÿåº¦ä¸åŒï¼‰
                let recoveryRate = 0.12; // é»˜è®¤æ¢å¤é€Ÿåº¦
                if (zoneType === 'core') recoveryRate = 0.03;
                else if (zoneType === 'middle') recoveryRate = 0.06;
                else if (zoneType === 'outer') recoveryRate = 0.09;
                else if (zoneType === 'edge') recoveryRate = 0.15;
                else if (zoneType === 'outside') recoveryRate = 0.18;
                
                restoreEnergy(recoveryRate);
            }

            // èƒ½é‡è€—å°½åˆ¤å®š - ç›´æ¥è·³è½¬åˆ°è¯Šæ–­é¡µé¢
            if (energy <= 0 && !isFrozen) {
                isFrozen = true;
                customCursor.style.background = '#f00';
                
                // æ’­æ”¾èƒ½é‡è€—å°½çš„ç‰¹æ®Šå£°éŸ³
                if (isAudioEnabled && audioContext) {
                    // åˆ›å»ºçŸ­æš‚çš„é«˜é¢‘å°–å•¸å£°
                    const screamOscillator = audioContext.createOscillator();
                    const screamGain = audioContext.createGain();
                    
                    screamOscillator.type = 'sine';
                    screamOscillator.frequency.setValueAtTime(1000, audioContext.currentTime);
                    screamOscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 1.5);
                    
                    screamGain.gain.setValueAtTime(0.5, audioContext.currentTime);
                    screamGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
                    
                    screamOscillator.connect(screamGain);
                    screamGain.connect(audioContext.destination);
                    
                    screamOscillator.start();
                    screamOscillator.stop(audioContext.currentTime + 1.5);
                }
                
                // çŸ­æš‚å»¶è¿Ÿåæ˜¾ç¤ºè¯Šæ–­é¡µé¢
                setTimeout(() => {
                    triggerDiagnosisOverlay();
                }, 500);
            }
        }

        // ========== æŒ‰é’®ç‚¹å‡»åˆ¤å®š ==========
        taskBtn.addEventListener('click', (e) => {
            if (isInCoreZone && isNearButton) {
                // åœ¨æ ¸å¿ƒåŒºä¸”æ¥è¿‘æŒ‰é’®æ—¶ç‚¹å‡» - æ’­æ”¾æˆåŠŸéŸ³æ•ˆ
                if (isAudioEnabled && audioContext) {
                    // åˆ›å»ºæˆåŠŸéŸ³æ•ˆ
                    const successOscillator = audioContext.createOscillator();
                    const successGain = audioContext.createGain();
                    
                    successOscillator.type = 'sine';
                    successOscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                    successOscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                    successOscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                    
                    successGain.gain.setValueAtTime(0, audioContext.currentTime);
                    successGain.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                    successGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    successOscillator.connect(successGain);
                    successGain.connect(audioContext.destination);
                    
                    successOscillator.start();
                    successOscillator.stop(audioContext.currentTime + 0.5);
                }
                
                // è®¡ç®—å®é™…åœ¨æŒ‰é’®é™„è¿‘çš„æ—¶é—´
                const actualTimeNearButton = timeNearButton;
                
                // æˆåŠŸç‚¹å‡»æŒ‰é’®
                const completionTime = attemptTimer;
                alert(`æˆåŠŸï¼æ‚¨çªç ´äº†é‡é‡é˜»åŠ›ï¼\næ€»è€—æ—¶ï¼š${completionTime.toFixed(1)}ç§’\nç¨³å®šæ—¶é—´ï¼š${actualTimeNearButton.toFixed(1)}ç§’\nå¤±è´¥æ¬¡æ•°ï¼š${failCount}æ¬¡\n\næ‚¨ç»ˆäºå¯ä»¥å¼€å§‹æ’°å†™å­£åº¦æŠ¥å‘Šäº†ï¼`);
                location.reload();
            } else {
                failCount++;
                if (failCount >= 3) {
                    // 3æ¬¡å¤±è´¥åç›´æ¥è·³è½¬åˆ°è¯Šæ–­é¡µé¢
                    triggerDiagnosisOverlay();
                }
            }
        });

        // ========== èƒ½é‡æ¡é€»è¾‘ ==========
        function reduceEnergy(amount) {
            energy = Math.max(0, energy - amount);
            energyFill.style.width = `${energy}%`;
            energyValue.textContent = `${Math.round(energy)}%`;
            
            // æ ¹æ®èƒ½é‡å€¼æ”¹å˜é¢œè‰²
            if (energy < 20) {
                energyValue.style.color = '#F44336';
                energyValue.style.fontWeight = 'bold';
            } else if (energy < 50) {
                energyValue.style.color = '#FF9800';
                energyValue.style.fontWeight = 'normal';
            } else {
                energyValue.style.color = '#333';
                energyValue.style.fontWeight = 'normal';
            }
        }

        function restoreEnergy(amount) {
            energy = Math.min(100, energy + amount);
            energyFill.style.width = `${energy}%`;
            energyValue.textContent = `${Math.round(energy)}%`;
            
            // æ ¹æ®èƒ½é‡å€¼æ”¹å˜é¢œè‰²
            if (energy < 20) {
                energyValue.style.color = '#F44336';
                energyValue.style.fontWeight = 'bold';
            } else if (energy < 50) {
                energyValue.style.color = '#FF9800';
                energyValue.style.fontWeight = 'normal';
            } else {
                energyValue.style.color = '#333';
                energyValue.style.fontWeight = 'normal';
            }
        }

        // ========== è§¦å‘è¯Šæ–­å›¾å±‚ ==========
        function triggerDiagnosisOverlay() {
            isFrozen = true;
            stopCurrentSound();
            stopTimer();
            diagnosisOverlay.style.display = 'flex';
            // éšè—ä¸­é—´æç¤º - åœ¨è¯Šæ–­é¡µé¢æ˜¾ç¤ºæ—¶éšè—é”å±æç¤º
            lockHint.style.display = 'none'; // ä½¿ç”¨display:noneè€Œä¸æ˜¯æ·»åŠ hiddenç±»
            // è§£é”é¼ æ ‡
            document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock;
            document.exitPointerLock();
            
            // éšè—å…¶ä»–UIå…ƒç´ 
            energyBar.style.display = 'none';
            energyValue.style.display = 'none';
            timerDisplay.style.display = 'none';
            resistanceIndicator.style.display = 'none';
            findButtonHint.style.display = 'none';
            distractionTimer.style.display = 'none';
            buttonInstruction.style.display = 'none';
            audioControl.style.display = 'none';
            zone1.style.display = 'none';
            zone2.style.display = 'none';
        }

        // å…³é—­è¯Šæ–­å›¾å±‚
        diagnosisOverlay.addEventListener('click', () => {
            diagnosisOverlay.style.display = 'none';
            // é‡æ–°æ˜¾ç¤ºé”å±æç¤º
            lockHint.style.display = 'block'; // é‡æ–°æ˜¾ç¤ºé”å±æç¤º
            lockHint.classList.remove('hidden');
            location.reload();
        });

        // ========== åˆå§‹åŒ–å…‰æ ‡ä½ç½® ==========
        function updateCursorPosition(e) {
            if (!isLocked) {
                mousePos.x = e.clientX;
                mousePos.y = e.clientY;
            }
        }
        
        // ç›‘å¬é¼ æ ‡ç§»åŠ¨ï¼Œæ›´æ–°å…‰æ ‡ä½ç½®
        document.addEventListener('mousemove', updateCursorPosition);
        
        // é¡µé¢å…³é—­æ—¶æ¸…ç†éŸ³é¢‘èµ„æº
        window.addEventListener('beforeunload', () => {
            if (audioContext) {
                audioContext.close();
            }
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            if (distractionTimerInterval) {
                clearInterval(distractionTimerInterval);
            }
        });
        
        // çª—å£è°ƒæ•´å¤§å°æ—¶é‡æ–°è®¡ç®—ä½ç½®
        window.addEventListener('resize', () => {
            const newRect = gravityWell.getBoundingClientRect();
            gravityWellCenter.x = newRect.left + newRect.width / 2;
            gravityWellCenter.y = newRect.top + newRect.height / 2;
            
            const newZone1Rect = zone1.getBoundingClientRect();
            const newZone2Rect = zone2.getBoundingClientRect();
            zone1Center.x = newZone1Rect.left + newZone1Rect.width / 2;
            zone1Center.y = newZone1Rect.top + newZone1Rect.height / 2;
            zone2Center.x = newZone2Rect.left + newZone2Rect.width / 2;
            zone2Center.y = newZone2Rect.top + newZone2Rect.height / 2;
        });
    </script>
</body>
</html>