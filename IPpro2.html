<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»»åŠ¡å¯åŠ¨å›°éš¾ - é‡åŠ›äº•ä¸æ’æ–¥åœº</title>
    <style>
        /* åŸºç¡€å¸ƒå±€ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        body {
            background: #f0f0f0;
            overflow: hidden; 
            height: 100vh;
            position: relative;
            cursor: default; /* é»˜è®¤ä½¿ç”¨ç³»ç»Ÿå…‰æ ‡ */
        }
        /* è‡ªå®šä¹‰é˜»åŠ›å…‰æ ‡ */
        .custom-cursor {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #666;
            pointer-events: none; /* ä¸é˜»æŒ¡ç‚¹å‡»äº‹ä»¶ */
            z-index: 9999;
            transition: transform 0.1s ease;
            display: none; /* åˆå§‹éšè—ï¼Œåªåœ¨é”å®šåæ˜¾ç¤º */
        }
        /* å…‰æ ‡æŠµæŠ—åŠ¨ç”» */
        @keyframes cursorResist {
            0% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(244, 67, 54, 0); }
            100% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0); }
        }
        /* é¼ æ ‡é”å®šçŠ¶æ€æ—¶çš„å…‰æ ‡æ ·å¼ */
        body.pointer-locked {
            cursor: none !important;
        }
        body.pointer-locked .custom-cursor {
            display: block;
        }
        /* æ ¸å¿ƒå·¥ä½œåŒºï¼šåœ†å½¢é‡åŠ›äº• */
        .gravity-well {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: 
                radial-gradient(
                    circle at center,
                    rgba(200, 200, 255, 0.1) 0%,
                    rgba(150, 150, 255, 0.05) 30%,
                    rgba(100, 100, 255, 0.02) 60%,
                    transparent 70%
                );
        }
        /* ä»»åŠ¡æŒ‰é’® - 59pxå¤§å° */
        .task-button-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 59px;
            height: 59px;
            border-radius: 50%;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .task-btn {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                radial-gradient(
                    circle at center,
                    #333 0%,
                    #222 100%
                );
            color: #fff;
            border: none;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s ease, background 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 
                0 0 15px rgba(0, 0, 0, 0.6),
                inset 0 0 8px rgba(255, 255, 255, 0.15);
            z-index: 2;
        }
        .task-btn:hover {
            transform: scale(1.05);
        }
        .task-btn::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 70%;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                rgba(255, 255, 255, 0.25) 0%,
                rgba(255, 255, 255, 0.1) 50%,
                transparent 70%
            );
            pointer-events: none;
        }
        .task-btn-text {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 8px;
        }
        .task-btn-title {
            font-size: 14px;
            margin-bottom: 2px;
            color: #fff;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
            white-space: nowrap;
        }
        .task-btn-subtitle {
            font-size: 8px;
            color: #ccc;
            white-space: nowrap;
        }
        /* æŒ‰é’®å‘¨å›´çš„é«˜é˜»åŠ›å…‰ç¯ */
        .button-halo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                rgba(255, 100, 100, 0.25) 0%,
                rgba(255, 100, 100, 0.15) 30%,
                transparent 70%
            );
            pointer-events: none;
            z-index: 3;
            animation: halo-pulse 1.5s infinite alternate;
        }
        @keyframes halo-pulse {
            0% { opacity: 0.15; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1.1); }
        }
        /* è¾¹ç¼˜å¨±ä¹åŒºï¼šGIFå®¹å™¨ - å¢å¼ºå¹¿å‘Šæ•ˆæœ */
        .entertainment-zones {
            position: absolute;
            width: 180px;
            height: 220px;
            border-radius: 12px;
            overflow: hidden;
            z-index: 10;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 3px solid #FF9800;
            animation: ad-pulse 2s infinite;
        }
        @keyframes ad-pulse {
            0%, 100% { 
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 8px 35px rgba(255, 152, 0, 0.6);
                transform: scale(1.02);
            }
        }
        .zone-1 {
            top: 40px;
            left: 40px;
        }
        .zone-2 {
            bottom: 40px;
            right: 40px;
        }
        .entertainment-gif {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #333; /* æ·»åŠ èƒŒæ™¯è‰²ä»¥é˜²å›¾ç‰‡åŠ è½½å¤±è´¥ */
        }
        /* å¹¿å‘Šæ ‡ç­¾ */
        .ad-label {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #FF9800;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 11;
            box-shadow: 0 3px 10px rgba(255, 152, 0, 0.5);
        }
        .zone-1 .ad-label {
            background: #2196F3;
            box-shadow: 0 3px 10px rgba(33, 150, 243, 0.5);
        }
        .zone-2 .ad-label {
            background: #E91E63;
            box-shadow: 0 3px 10px rgba(233, 30, 99, 0.5);
        }
        /* èƒ½é‡æ¡ - åŠ é•¿ç‰ˆæœ¬ */
        .energy-bar {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 1000px;
            height: 30px;
            background: #eee;
            border-radius: 15px;
            overflow: hidden;
            display: block;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border: 3px solid #ddd;
        }
        .energy-fill {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, 
                #4CAF50 0%, 
                #8BC34A 25%, 
                #FFC107 50%, 
                #FF9800 75%, 
                #F44336 100%);
            transition: width 0.05s linear;
            position: relative;
        }
        .energy-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.4), 
                transparent);
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        /* èƒ½é‡æ•°å€¼æ˜¾ç¤º */
        .energy-value {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        /* è¯Šæ–­å›¾å±‚ */
        .diagnosis-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            color: #fff;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 50px;
            z-index: 999;
            filter: grayscale(1);
            background-image: linear-gradient(transparent 50%, rgba(255,0,0,0.2) 50%);
            background-size: 100% 4px;
            animation: scanline 0.1s linear infinite;
        }
        @keyframes scanline {
            0% { background-position: 0 0; }
            100% { background-position: 0 10px; }
        }
        .diagnosis-content {
            max-width: 800px;
            line-height: 1.8;
        }
        /* å¬è§‰åé¦ˆæç¤º */
        .audio-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #666;
            font-size: 14px;
        }
        /* é¼ æ ‡é”å®šæç¤º */
        .lock-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 18px;
            z-index: 1000;
            background: rgba(255,255,255,0.8);
            padding: 20px 40px;
            border-radius: 8px;
            transition: opacity 0.3s ease;
            text-align: center;
        }
        .lock-hint.hidden {
            opacity: 0;
            pointer-events: none;
        }
        /* å£°éŸ³æ§åˆ¶æŒ‰é’® */
        .audio-control {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        .audio-control:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        /* è®¡æ—¶å™¨æ˜¾ç¤º */
        .timer-display {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
            color: #333;
            background: rgba(255,255,255,0.8);
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        /* é˜»åŠ›æŒ‡ç¤ºå™¨ */
        .resistance-indicator {
            position: absolute;
            top: 110px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: #666;
            background: rgba(255,255,255,0.8);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
        }
        /* æŒ‰é’®æç¤º - ç½‘é¡µä¸‹æ–¹ï¼ˆç®€åŒ–ç‰ˆï¼‰ */
        .button-instruction {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 18px;
            color: #333;
            text-align: center;
            z-index: 100;
        }
        /* å¾®å°æŒ‰é’®å¯»æ‰¾æç¤º */
        .find-button-hint {
            position: absolute;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #999;
            background: rgba(255,255,255,0.6);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
            font-style: italic;
        }
        /* åˆ†å¿ƒå€’è®¡æ—¶æç¤º - æ”¹ä¸º1ç§’ */
        .distraction-timer {
            position: absolute;
            top: 180px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #FF9800;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            display: none;
            box-shadow: 0 3px 10px rgba(255, 152, 0, 0.3);
        }
        /* å¹¿å‘Šå¸å¼•åŒºåŸŸå…‰ç¯ */
        .ad-attraction-halo {
            position: absolute;
            width: 380px;
            height: 420px;
            border-radius: 20px;
            background: radial-gradient(
                ellipse at center,
                rgba(255, 152, 0, 0.08) 0%,
                rgba(255, 152, 0, 0.03) 40%,
                transparent 70%
            );
            pointer-events: none;
            z-index: 4;
            display: none;
            animation: ad-halo-pulse 2s infinite alternate;
        }
        @keyframes ad-halo-pulse {
            0% { opacity: 0.05; transform: scale(1); }
            100% { opacity: 0.1; transform: scale(1.02); }
        }
        .zone-1 .ad-attraction-halo {
            top: -100px;
            left: -100px;
            background: radial-gradient(
                ellipse at center,
                rgba(33, 150, 243, 0.08) 0%,
                rgba(33, 150, 243, 0.03) 40%,
                transparent 70%
            );
        }
        .zone-2 .ad-attraction-halo {
            top: -100px;
            left: -100px;
            background: radial-gradient(
                ellipse at center,
                rgba(233, 30, 99, 0.08) 0%,
                rgba(233, 30, 99, 0.03) 40%,
                transparent 70%
            );
        }
        /* ä¸­å¿ƒåŒºåŸŸä¿æŒæç¤º */
        .center-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
            color: #4CAF50;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 8px;
            z-index: 1002;
            box-shadow: 0 3px 15px rgba(76, 175, 80, 0.6);
            display: none;
            text-align: center;
            font-weight: bold;
        }
        /* ç¬¬äºŒç•Œé¢ï¼šæˆåŠŸç•Œé¢ */
        .success-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 50px;
            z-index: 9999;
            font-family: 'Arial', sans-serif;
            text-align: center;
        }
        .success-content {
            max-width: 800px;
            line-height: 1.8;
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        .success-title {
            font-size: 48px;
            margin-bottom: 20px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .success-subtitle {
            font-size: 24px;
            margin-bottom: 30px;
            color: #e3f2fd;
        }
        .stats-container {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .stat-box {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 12px;
            margin: 10px;
            min-width: 150px;
            backdrop-filter: blur(5px);
        }
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            color: #bbdefb;
        }
        .continue-btn {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }
        .continue-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.6);
            background: linear-gradient(45deg, #45a049, #7cb342);
        }
        .neuro-reflection {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border-left: 4px solid #4CAF50;
        }
        .reflection-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #c8e6c9;
        }
        .reflection-text {
            font-size: 16px;
            line-height: 1.6;
            color: #e8f5e9;
        }
        .celebration-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 20px;
            background: #f0f;
            animation: fall 5s linear infinite;
        }
        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        .back-to-start {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .back-to-start:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        /* å¤±è´¥æ¬¡æ•°æ˜¾ç¤º */
        .fail-count-display {
            position: absolute;
            top: 140px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: #F44336;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(244, 67, 54, 0.3);
        }
        /* ç¬¬ä¸‰ç•Œé¢ï¼šåä»»åŠ¡åˆ†æ•£å¸ƒå±€ */
        .ten-tasks-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            overflow: hidden;
            cursor: none; /* éšè—é»˜è®¤å…‰æ ‡ */
        }
        
        .ten-tasks-title {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
            color: #333;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }
        
        .ten-tasks-instruction {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            color: #666;
            text-align: center;
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 15px;
            border-radius: 5px;
            z-index: 10;
        }
        
        .ten-tasks-container {
            position: relative;
            width: 100%;
            height: 80%;
            margin-top: 100px;
        }
        
        /* ä¿®æ”¹ï¼šå°†æ‰€æœ‰ä»»åŠ¡æŒ‰é’®éƒ½è®¾ä¸ºç°è‰² */
        .scattered-task-btn {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle at center, #777 0%, #555 100%); /* ç°è‰² */
            color: #fff;
            border: none;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5),
                        inset 0 0 5px rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            z-index: 5;
            text-align: center;
            padding: 5px;
        }
        
        .scattered-task-btn:hover {
            transform: scale(1.05);
        }
        
        .scattered-task-btn::before {
            content: '';
            position: absolute;
            width: 60%;
            height: 60%;
            border-radius: 50%;
            background: radial-gradient(circle at center,
                    rgba(255, 255, 255, 0.2) 0%,
                    rgba(255, 255, 255, 0.1) 50%,
                    transparent 70%);
            pointer-events: none;
        }
        
        .scattered-task-btn-text {
            position: relative;
            z-index: 2;
        }
        
        .scattered-task-btn-title {
            font-size: 11px;
            margin-bottom: 2px;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            line-height: 1.2;
        }
        
        .scattered-task-btn-attraction {
            position: absolute;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                rgba(255, 100, 100, 0.4) 0%,
                rgba(255, 100, 100, 0.2) 40%,
                transparent 70%
            );
            pointer-events: none;
            z-index: 4;
            display: none;
        }
        
        /* ä¿®æ”¹ï¼šç§»é™¤æ‰€æœ‰ç‰¹æ®Šé¢œè‰²ç±»ï¼Œæ‰€æœ‰æŒ‰é’®éƒ½æ˜¯ç°è‰² */
        
        .mouse-jump-indicator {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #2196F3;
            pointer-events: none;
            z-index: 999;
            display: none;
            animation: jump-indicator 0.5s ease-out;
        }
        
        @keyframes jump-indicator {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(1); opacity: 0; }
        }
        
        .ten-tasks-timer {
            position: absolute;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
            color: #333;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        .ten-tasks-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: #666;
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 15px;
            border-radius: 8px;
            text-align: center;
            z-index: 10;
        }
        
        .ten-tasks-back-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            z-index: 10;
        }
        
        .ten-tasks-back-btn:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        
        /* å¸å¼•æ•ˆæœ - å¢å¼ºç‰ˆ */
        .attraction-effect {
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                rgba(255, 100, 100, 0.5) 0%,
                rgba(255, 100, 100, 0.3) 40%,
                transparent 70%
            );
            pointer-events: none;
            z-index: 3;
            animation: attraction-pulse 1s infinite alternate;
            display: block !important;
        }
        
        @keyframes attraction-pulse {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.4; }
            100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.8; }
        }
        
        /* çº¢è‰²åœ†ç‚¹å…‰æ ‡ - åä»»åŠ¡ç•Œé¢ä¸“ç”¨ */
        .ten-tasks-cursor {
            position: absolute;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #F44336;
            pointer-events: none;
            z-index: 9999;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.8),
                        0 0 20px rgba(244, 67, 54, 0.6);
            transition: all 0.1s ease;
            display: none;
        }
        
        /* ä¿®æ”¹ï¼šç§»é™¤æ­£ç¡®ä»»åŠ¡çš„ç‰¹æ®Šå…‰ç¯ */
    </style>
</head>
<body>
    <!-- å£°éŸ³æ§åˆ¶æŒ‰é’® -->
    <button class="audio-control" id="audioControl">ğŸ”Š å¼€å¯å£°éŸ³</button>
    
    <!-- è‡ªå®šä¹‰é˜»åŠ›å…‰æ ‡ -->
    <div class="custom-cursor" id="customCursor"></div>
    <!-- åä»»åŠ¡ç•Œé¢ä¸“ç”¨çº¢è‰²åœ†ç‚¹å…‰æ ‡ -->
    <div class="ten-tasks-cursor" id="tenTasksCursor"></div>
    <!-- é¼ æ ‡é”å®šæç¤º -->
    <div class="lock-hint" id="lockHint">ç‚¹å‡»é¡µé¢å¼€å§‹ä½“éªŒï¼ŒæŒ‰Escé€€å‡ºä½“éªŒ</div>

    <!-- æ ¸å¿ƒå·¥ä½œåŒº -->
    <div class="gravity-well" id="gravityWell">
        <!-- æŒ‰é’®å‘¨å›´çš„å…‰ç¯ -->
        <div class="button-halo" id="buttonHalo"></div>
        
        <!-- ä»»åŠ¡æŒ‰é’® -->
        <div class="task-button-container" id="taskButtonContainer">
            <button class="task-btn" id="taskBtn">
                <div class="task-btn-text">
                    <div class="task-btn-title">å¼€å§‹å·¥ä½œ</div>
                    <div class="task-btn-subtitle">å­£åº¦æŠ¥å‘Š</div>
                </div>
            </button>
        </div>
    </div>

    <!-- è¾¹ç¼˜å¨±ä¹åŒº/å¹¿å‘ŠåŒº -->
    <div class="entertainment-zones zone-1" id="zone1">
        <div class="ad-label">æç¬‘è§†é¢‘</div>
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExeHF4OWV2bTV2Mnd0OW96a2w4aGJmOWE4OWY2bWg4N2U1YzA1ZiZlcD12MV9pbnRlcm5hbF9naWZzX2dpZklkJmN0PWc/JIX9t2j0ZTN9S/giphy.gif" alt="çŒ«å’ªä¿ƒé”€" class="entertainment-gif">
        <div class="ad-attraction-halo" id="halo1"></div>
    </div>
    <div class="entertainment-zones zone-2" id="zone2">
        <div class="ad-label">å›¢è´­ä¿ƒé”€</div>
        <img src="https://picsum.photos/181/221?random=2" alt="çƒ­é—¨æ¸¸æˆ" class="entertainment-gif">
        <div class="ad-attraction-halo" id="halo2"></div>
    </div>

    <!-- èƒ½é‡æ¡ -->
    <div class="energy-bar" id="energyBar">
        <div class="energy-fill" id="energyFill"></div>
    </div>
    
    <!-- èƒ½é‡æ•°å€¼æ˜¾ç¤º -->
    <div class="energy-value" id="energyValue">100%</div>
    
    <!-- è®¡æ—¶å™¨æ˜¾ç¤º -->
    <div class="timer-display" id="timerDisplay">å°è¯•æ—¶é—´: 0.0ç§’</div>
    
    <!-- é˜»åŠ›æŒ‡ç¤ºå™¨ -->
    <div class="resistance-indicator" id="resistanceIndicator">å½“å‰é˜»åŠ›: 0%</div>
    
    <!-- å¤±è´¥æ¬¡æ•°æ˜¾ç¤º -->
    <div class="fail-count-display" id="failCountDisplay">å¤±è´¥æ¬¡æ•°: 0</div>
    
    <!-- å¾®å°æŒ‰é’®å¯»æ‰¾æç¤º -->
    <div class="find-button-hint" id="findButtonHint"></div>
    
    <!-- åˆ†å¿ƒå€’è®¡æ—¶æç¤º -->
    <div class="distraction-timer" id="distractionTimer">åˆ†å¿ƒå€’è®¡æ—¶: 1.0ç§’</div>
    
    <!-- æŒ‰é’®æç¤º - ç½‘é¡µä¸‹æ–¹ï¼ˆç®€åŒ–ç‰ˆï¼‰ -->
    <div class="button-instruction">æŒ‰ä¸‹æŒ‰é’®å¼€å§‹ä¸‹ä¸€æ­¥</div>
    
    <!-- ä¸­å¿ƒåŒºåŸŸä¿æŒæç¤º -->
    <div class="center-hint" id="centerHint"></div>

    <!-- ç¬¬äºŒç•Œé¢ï¼šæˆåŠŸç•Œé¢ -->
    <div class="success-screen" id="successScreen">
        <div class="success-content">
            <h1 class="success-title">ğŸ‰ ä»»åŠ¡å¯åŠ¨æˆåŠŸï¼</h1>
            <h2 class="success-subtitle">æ‚¨æˆåŠŸå…‹æœäº†ADHDçš„è®¤çŸ¥é˜»åŠ›</h2>
            
            <div class="stats-container">
                <div class="stat-box">
                    <div class="stat-value" id="finalTime">0.0s</div>
                    <div class="stat-label">æ€»è€—æ—¶</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalStableTime">0.0s</div>
                    <div class="stat-label">ç¨³å®šæ—¶é—´</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalFails">0</div>
                    <div class="stat-label">å¤±è´¥æ¬¡æ•°</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalEnergy">100%</div>
                    <div class="stat-label">å‰©ä½™èƒ½é‡</div>
                </div>
            </div>
            
            <div class="neuro-reflection">
                <h3 class="reflection-title">ğŸ§  ç¥ç»è®¤çŸ¥åæ€</h3>
                <p class="reflection-text">
                    æ‚¨åˆšæ‰ä½“éªŒåˆ°çš„"é˜»åŠ›"ã€"æ’æ–¥"å’Œ"åˆ†å¿ƒ"ï¼Œæ­£æ˜¯ADHDå¤§è„‘åœ¨æ‰§è¡Œæ¯ç‡¥ä»»åŠ¡æ—¶çš„çœŸå®æ„Ÿå—ã€‚<br>
                    è®°ä½è¿™ç§æ„Ÿè§‰â€”â€”ä¸‹æ¬¡å½“æ‚¨è§‰å¾—"æ— æ³•å¼€å§‹"æ—¶ï¼Œå›æƒ³è¿™æ¬¡çš„æˆåŠŸç»éªŒã€‚
                </p>
            </div>
            
            <button class="continue-btn" id="continueBtn">ç»§ç»­æŒ‘æˆ˜ä¸‹ä¸€ä¸ªä»»åŠ¡</button>
            <button class="back-to-start" id="backToStart">â†© è¿”å›å¼€å§‹</button>
        </div>
        
        <!-- åº†ç¥åŠ¨ç”» -->
        <div class="celebration-animation" id="celebrationAnimation"></div>
    </div>

    <!-- ç¬¬ä¸‰ç•Œé¢ï¼šåä»»åŠ¡åˆ†æ•£å¸ƒå±€ -->
    <div class="ten-tasks-screen" id="tenTasksScreen">
        <h2 class="ten-tasks-title">é€‰æ‹©æ­£ç¡®çš„ä»»åŠ¡å¼€å§‹</h2>
        <div class="ten-tasks-instruction">9ä¸ªå¹²æ‰°ä»»åŠ¡ vs 1ä¸ªæ­£ç¡®ä»»åŠ¡</div>
        <div class="ten-tasks-timer" id="tenTasksTimer">æ—¶é—´: 0.0ç§’</div>
        <div class="ten-tasks-hint" id="tenTasksHint">é¼ æ ‡æ¯1ç§’ä¼šè·³è½¬åˆ°éšæœºå¹²æ‰°ä»»åŠ¡ä¸Šï¼Œæ‰€æœ‰å¹²æ‰°ä»»åŠ¡éƒ½å¯¹é¼ æ ‡æœ‰å¼ºçƒˆå¸å¼•åŠ›</div>
        <button class="ten-tasks-back-btn" id="tenTasksBackBtn">è¿”å›å¼€å§‹</button>
        
        <div class="ten-tasks-container" id="tenTasksContainer">
            <!-- 10ä¸ªä»»åŠ¡æŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <!-- è¯Šæ–­å›¾å±‚ -->
    <div class="diagnosis-overlay" id="diagnosisOverlay">
        <div class="diagnosis-content">
            <h2>ç¥ç»ç—…ç†å­¦è¯Šæ–­ï¼šå¯åŠ¨ç³»ç»Ÿç˜«ç—ªï¼ˆInitiation Paralysisï¼‰</h2>
            <h3>ã€æ£€æµ‹åˆ°æ„æ„¿ä¸è¡ŒåŠ¨æ–­è£‚ã€‘</h3>
            <p>ä¸ºä»€ä¹ˆä½ ç‚¹ä¸åˆ°é‚£ä¸ªæŒ‰é’®ï¼Ÿä½ åˆšæ‰çš„ä½“éªŒï¼Œç²¾å‡†å¤åˆ»äº†ADHDæ‚£è€…é¢å¯¹"æ¯ç‡¥ä»»åŠ¡"æ—¶çš„å¤§è„‘é£æš´ï¼š</p>
            <ol>
                <li><strong>å¤šå·´èƒºèµ¤å­—ï¼ˆDopamine Deficitï¼‰</strong>ï¼šé‚£ä¸ªåƒèƒ¶æ°´ä¸€æ ·çš„è¿Ÿæ»æ„Ÿï¼Œæ¨¡æ‹Ÿäº†å¤§è„‘ç¼ºä¹å¤šå·´èƒºçš„çŠ¶æ€ã€‚å¤šå·´èƒºæ˜¯è¡ŒåŠ¨çš„"ç‡ƒæ–™"ï¼Œæ²¡æœ‰å®ƒï¼Œå³ä½¿ä½ æƒ³åšï¼Œå¤§è„‘çš„ç‚¹ç«å™¨ä¹Ÿæ‰“ä¸ç€ç«ã€‚</li>
                <li><strong>å‰è„‘å²›æ¿€æ´»ï¼ˆInsula Activationï¼‰</strong>ï¼šå½“ä½ é è¿‘æŒ‰é’®æ—¶æ„Ÿå—åˆ°çš„"æ–¥åŠ›"å’Œ"ç„¦è™‘"ï¼Œæ˜¯å› ä¸ºADHDæ‚£è€…çš„å¤§è„‘å‰è„‘å²›åŒºåŸŸè¿‡åº¦æ¿€æ´»ã€‚å®ƒå°†"å†™æŠ¥å‘Š"è¿™ç§æ— èŠä»»åŠ¡è¯†åˆ«ä¸º"ç‰©ç†ç–¼ç—›"ï¼Œå¹¶ä¸‹è¾¾äº†"æ’¤é€€"çš„ç”Ÿç†æŒ‡ä»¤ã€‚</li>
                <li><strong>æ„å‘æ€§å¤±æ•ˆ</strong>ï¼šä½ åˆšæ‰æ˜¯ä¸æ˜¯æ¾äº†ä¸€å£æ°”ï¼Œå…‰æ ‡å°±é£å‡ºå»äº†ï¼Ÿè¿™å«æ„å‘æ€§å¤±æ•ˆã€‚ä½ çš„å‰é¢å¶çš®å±‚æ— æ³•ç»´æŒæŒç»­çš„è¡ŒåŠ¨æŒ‡ä»¤ï¼Œæ³¨æ„åŠ›åƒæ°´ä¸€æ ·æµå‘äº†é˜»åŠ›æœ€å°ï¼ˆæœ€å¥½ç©ï¼‰çš„åœ°æ–¹ã€‚</li>
            </ol>
            <p><strong>ç»“è®º</strong>ï¼šADHDçš„æ‹–å»¶ä¸æ˜¯"æˆ‘é€‰æ‹©ä¸åš"ï¼Œè€Œæ˜¯"æˆ‘æ‹¼å‘½è¸©æ²¹é—¨ï¼Œä½†å¼•æ“æ²¡æœ‰è¿æ¥åˆ°è½®å­ä¸Š"ã€‚</p>
        </div>
    </div>

    <!-- å¬è§‰åé¦ˆæç¤º -->
    <div class="audio-hint">æç¤ºï¼šå¼€å¯å£°éŸ³ä½“éªŒè€³é¸£æ•ˆæœ</div>

    <script>
        // æ ¸å¿ƒå…ƒç´ è·å–
        const gravityWell = document.getElementById('gravityWell');
        const taskBtn = document.getElementById('taskBtn');
        const taskButtonContainer = document.getElementById('taskButtonContainer');
        const buttonHalo = document.getElementById('buttonHalo');
        const zone1 = document.getElementById('zone1');
        const zone2 = document.getElementById('zone2');
        const halo1 = document.getElementById('halo1');
        const halo2 = document.getElementById('halo2');
        const energyBar = document.getElementById('energyBar');
        const energyFill = document.getElementById('energyFill');
        const energyValue = document.getElementById('energyValue');
        const diagnosisOverlay = document.getElementById('diagnosisOverlay');
        const customCursor = document.getElementById('customCursor');
        const tenTasksCursor = document.getElementById('tenTasksCursor'); // æ–°å¢ï¼šåä»»åŠ¡ç•Œé¢çº¢è‰²å…‰æ ‡
        const lockHint = document.getElementById('lockHint');
        const audioControl = document.getElementById('audioControl');
        const timerDisplay = document.getElementById('timerDisplay');
        const resistanceIndicator = document.getElementById('resistanceIndicator');
        const findButtonHint = document.getElementById('findButtonHint');
        const distractionTimer = document.getElementById('distractionTimer');
        const buttonInstruction = document.querySelector('.button-instruction');
        const centerHint = document.getElementById('centerHint');
        const successScreen = document.getElementById('successScreen');
        const finalTime = document.getElementById('finalTime');
        const finalStableTime = document.getElementById('finalStableTime');
        const finalFails = document.getElementById('finalFails');
        const finalEnergy = document.getElementById('finalEnergy');
        const continueBtn = document.getElementById('continueBtn');
        const backToStart = document.getElementById('backToStart');
        const celebrationAnimation = document.getElementById('celebrationAnimation');
        const failCountDisplay = document.getElementById('failCountDisplay');
        const tenTasksScreen = document.getElementById('tenTasksScreen');
        const tenTasksContainer = document.getElementById('tenTasksContainer');
        const tenTasksTimer = document.getElementById('tenTasksTimer');
        const tenTasksHint = document.getElementById('tenTasksHint');
        const tenTasksBackBtn = document.getElementById('tenTasksBackBtn');
        const body = document.body;
        
        // ========== Web Audio API éŸ³é¢‘ç³»ç»Ÿ ==========
        let audioContext;
        let oscillator;
        let gainNode;
        let noiseGainNode;
        let noiseNode;
        let filterNode;
        let isAudioEnabled = false;
        let isPlaying = false;
        
        // åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            // åˆ›å»ºä½é¢‘æŒ¯è¡å™¨ï¼ˆç”µæµå£°åŸºç¡€ï¼‰
            oscillator = audioContext.createOscillator();
            oscillator.type = 'sawtooth'; // é”¯é½¿æ³¢äº§ç”Ÿç±»ä¼¼ç”µæµçš„å£°éŸ³
            oscillator.frequency.value = 60; // 60Hzä½é¢‘ï¼Œç±»ä¼¼ç”µæµå£°
            
            // åˆ›å»ºç™½å™ªå£°æºï¼ˆç”¨äºè€³é¸£æ•ˆæœï¼‰
            noiseNode = audioContext.createBufferSource();
            const bufferSize = audioContext.sampleRate * 2;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const output = buffer.getChannelData(0);
            
            // å¡«å……ç™½å™ªå£°
            for (let i = 0; i < bufferSize; i++) {
                output[i] = Math.random() * 2 - 1;
            }
            
            noiseNode.buffer = buffer;
            noiseNode.loop = true;
            
            // åˆ›å»ºæ»¤æ³¢å™¨ï¼ˆæ¨¡æ‹Ÿè€³é¸£çš„é«˜é¢‘ç‰¹æ€§ï¼‰
            filterNode = audioContext.createBiquadFilter();
            filterNode.type = 'bandpass';
            filterNode.frequency.value = 8000; // é«˜é¢‘è€³é¸£
            filterNode.Q.value = 1;
            
            // åˆ›å»ºå¢ç›ŠèŠ‚ç‚¹æ§åˆ¶éŸ³é‡
            gainNode = audioContext.createGain();
            gainNode.gain.value = 0; // åˆå§‹éŸ³é‡ä¸º0
            
            // åˆ›å»ºå™ªå£°å¢ç›ŠèŠ‚ç‚¹
            noiseGainNode = audioContext.createGain();
            noiseGainNode.gain.value = 0;
            
            // è¿æ¥èŠ‚ç‚¹
            oscillator.connect(gainNode);
            noiseNode.connect(filterNode);
            filterNode.connect(noiseGainNode);
            gainNode.connect(audioContext.destination);
            noiseGainNode.connect(audioContext.destination);
            
            // å¯åŠ¨æŒ¯è¡å™¨å’Œå™ªå£°
            oscillator.start();
            noiseNode.start();
            
            isAudioEnabled = true;
            audioControl.textContent = "ğŸ”Š å…³é—­å£°éŸ³";
        }
        
        // æ’­æ”¾ç”µæµå£°
        function playCurrentSound(intensity = 0.3) {
            if (!isAudioEnabled || !audioContext || audioContext.state === 'suspended') {
                return;
            }
            
            // æ ¹æ®å¼ºåº¦è°ƒæ•´å£°éŸ³å‚æ•°
            const baseFreq = 60 + (intensity * 40); // é¢‘ç‡éšå¼ºåº¦å˜åŒ–
            const volume = Math.min(0.5, intensity * 0.8); // éŸ³é‡éšå¼ºåº¦å˜åŒ–
            const noiseVolume = Math.min(0.2, intensity * 0.3); // å™ªå£°éŸ³é‡
            
            // ä½¿ç”¨æŒ‡æ•°å˜åŒ–ä½¿è¿‡æ¸¡æ›´å¹³æ»‘
            oscillator.frequency.exponentialRampToValueAtTime(
                baseFreq, 
                audioContext.currentTime + 0.1
            );
            
            gainNode.gain.exponentialRampToValueAtTime(
                volume, 
                audioContext.currentTime + 0.1
            );
            
            noiseGainNode.gain.exponentialRampToValueAtTime(
                noiseVolume, 
                audioContext.currentTime + 0.1
            );
            
            // éšæœºè°ƒåˆ¶æ»¤æ³¢å™¨é¢‘ç‡æ¨¡æ‹Ÿè€³é¸£å˜åŒ–
            filterNode.frequency.setValueAtTime(
                7000 + Math.random() * 2000, 
                audioContext.currentTime
            );
            
            isPlaying = true;
        }
        
        // åœæ­¢ç”µæµå£°
        function stopCurrentSound() {
            if (!isAudioEnabled || !audioContext) return;
            
            // å¹³æ»‘æ·¡å‡º
            gainNode.gain.exponentialRampToValueAtTime(
                0.001, 
                audioContext.currentTime + 0.5
            );
            
            noiseGainNode.gain.exponentialRampToValueAtTime(
                0.001, 
                audioContext.currentTime + 0.5
            );
            
            isPlaying = false;
        }
        
        // åˆ‡æ¢éŸ³é¢‘çŠ¶æ€
        function toggleAudio() {
            if (!isAudioEnabled) {
                initAudio();
                // ç”¨æˆ·äº¤äº’åæ¢å¤éŸ³é¢‘ä¸Šä¸‹æ–‡
                if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
            } else {
                if (audioContext) {
                    audioContext.suspend();
                    isAudioEnabled = false;
                    audioControl.textContent = "ğŸ”‡ å¼€å¯å£°éŸ³";
                }
            }
        }
        
        // éŸ³é¢‘æ§åˆ¶æŒ‰é’®äº‹ä»¶
        audioControl.addEventListener('click', () => {
            toggleAudio();
        });
        
        // é¡µé¢ç‚¹å‡»æ—¶åˆå§‹åŒ–éŸ³é¢‘ï¼ˆéµå¾ªæµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥ï¼‰
        document.addEventListener('click', () => {
            if (!audioContext && isAudioEnabled) {
                initAudio();
            }
        });
        
        // ========== çŠ¶æ€å˜é‡ ==========
        const GRAVITY_WELL_RADIUS = 200; // é‡åŠ›äº•è§†è§‰åŠå¾„ï¼ˆæ˜¾ç¤ºåŒºåŸŸï¼‰
        const RESISTANCE_AREA_RADIUS = 400; // é˜»åŠ›ä½œç”¨åŒºåŸŸåŠå¾„ï¼ˆæ‰©å¤§åˆ°400pxï¼‰
        const BUTTON_RADIUS = 29.5; // æŒ‰é’®åŠå¾„ï¼ˆ59pxç›´å¾„çš„ä¸€åŠï¼‰
        const HALO_RADIUS = 50; // å…‰ç¯åŠå¾„
        
        // ä¿®æ”¹é˜»åŠ›åŒºåŸŸå‚æ•° - æ‰©å¤§é˜»åŠ›èŒƒå›´å’Œé¢ç§¯
        const HIGH_RESISTANCE_RADIUS = 200; // é«˜é˜»åŠ›åŒºåŸŸåŠå¾„ (ç»Ÿä¸€80%é˜»åŠ›) æ‰©å¤§åˆ°200px
        const MEDIUM_RESISTANCE_RADIUS = 300; // ä¸­ç­‰é˜»åŠ›åŒºåŸŸåŠå¾„
        const LOW_RESISTANCE_RADIUS = 350; // ä½é˜»åŠ›åŒºåŸŸåŠå¾„
        
        // å¹¿å‘Šå¸å¼•åŒºåŸŸå‚æ•° - è°ƒæ•´åˆ°100pxèŒƒå›´
        const AD_ATTRACTION_RADIUS = 100; // å¹¿å‘Šå¸å¼•åŠå¾„ï¼ˆä»350å‡å°åˆ°100pxï¼‰
        const AD_ATTRACTION_FORCE = 0.15; // å¹¿å‘Šå¸å¼•åŠ›å¤§å°
        
        const DISTRACTION_TIMEOUT = 1000; // 1ç§’åˆ†å¿ƒå€’è®¡æ—¶
        
        // ä¸­å¿ƒåŒºåŸŸä¿æŒå˜é‡
        const CENTER_ZONE_RADIUS = 40; // ä¸­å¿ƒåŒºåŸŸåŠå¾„40pxï¼ˆæ€»ç›´å¾„80pxï¼‰
        const CENTER_HOLD_TIME = 2000; // éœ€è¦ä¿æŒ2ç§’ï¼ˆ2000æ¯«ç§’ï¼‰
        
        // èƒ½é‡æ¶ˆè€—å‚æ•°
        const RESISTANCE_ENERGY_COST_MULTIPLIER = 2.0; // é˜»åŠ›èƒ½é‡æ¶ˆè€—å€å¢å™¨ï¼ˆåŸ1.0ï¼‰
        const AD_ESCAPE_ENERGY_COST_MULTIPLIER = 2.0; // é€ƒç¦»å¹¿å‘Šèƒ½é‡æ¶ˆè€—å€å¢å™¨ï¼ˆä»3.0é™ä½åˆ°2.0ï¼‰
        const BUTTON_REPULSION_ENERGY_COST_MULTIPLIER = 1.5; // æŒ‰é’®æ’æ–¥èƒ½é‡æ¶ˆè€—å€å¢å™¨
        
        let mousePos = { x: window.innerWidth/2, y: window.innerHeight/2 };
        let isLocked = false;
        let isNearButton = false;
        let isInCoreZone = false;
        let energy = 100;
        let failCount = 0; // å¤±è´¥æ¬¡æ•°è®¡æ•°å™¨
        let isFrozen = false;
        let isInsideGravityWell = false;
        let startTime = 0;
        let attemptTimer = 0;
        let timerInterval = null;
        let energyDepletionStartTime = 0;
        let timeNearButton = 0;
        let currentResistance = 0;
        let buttonFound = false;
        let buttonOffset = { x: 0, y: 0 }; // æŒ‰é’®å½“å‰ä½ç½®åç§»
        let canClickButton = false; // æ˜¯å¦å¯ä»¥ç‚¹å‡»æŒ‰é’®
        
        // åˆ†å¿ƒå€’è®¡æ—¶ç›¸å…³å˜é‡
        let lastMouseMoveTime = 0;
        let distractionTimerInterval = null;
        let distractionCountdown = 1.0; // 1.0ç§’
        let isDistractionActive = false;
        
        // æ–°å¢ï¼šä¸­å¿ƒåŒºåŸŸä¿æŒè®¡æ—¶å˜é‡
        let centerHoldStartTime = 0;
        let isInCenterZone = false;
        let centerHoldInterval = null;

        // é‡åŠ›äº•ä¸­å¿ƒä½ç½®è®¡ç®—
        const gravityWellRect = gravityWell.getBoundingClientRect();
        const gravityWellCenter = {
            x: gravityWellRect.left + gravityWellRect.width / 2,
            y: gravityWellRect.top + gravityWellRect.height / 2
        };

        // è·å–å¹¿å‘ŠåŒºåŸŸä½ç½®å’Œå°ºå¯¸
        const zone1Rect = zone1.getBoundingClientRect();
        const zone2Rect = zone2.getBoundingClientRect();
        const zone1Center = {
            x: zone1Rect.left + zone1Rect.width / 2,
            y: zone1Rect.top + zone1Rect.height / 2
        };
        const zone2Center = {
            x: zone2Rect.left + zone2Rect.width / 2,
            y: zone2Rect.top + zone2Rect.height / 2
        };

        // ========== åä»»åŠ¡åˆ†æ•£å¸ƒå±€å˜é‡ ==========
        let tenTasksStartTime = 0;
        let tenTasksTimerInterval = null;
        let tenTasksAttemptTimer = 0;
        let tenTasksButtons = [];
        let tenTasksMouseJumpInterval = null;
        let correctTaskIndex = 0;
        let mouseJumpCount = 0;
        let isTenTasksLocked = false;
        let attractionSoundOscillator = null; // å¸å¼•åŠ›å—¡é¸£å£°æŒ¯è¡å™¨
        let attractionSoundGain = null; // å¸å¼•åŠ›å—¡é¸£å£°å¢ç›Š
        let isAttractionSoundPlaying = false; // æ˜¯å¦æ­£åœ¨æ’­æ”¾å¸å¼•åŠ›å—¡é¸£å£°

        // ========== è®¡æ—¶å™¨åŠŸèƒ½ ==========
        function startTimer() {
            startTime = Date.now();
            energyDepletionStartTime = 0;
            timeNearButton = 0;
            lastMouseMoveTime = Date.now(); // åˆå§‹åŒ–æœ€åç§»åŠ¨æ—¶é—´
            
            // æ–°å¢ï¼šä½“éªŒå¼€å§‹æ—¶å°†é¼ æ ‡ä½ç½®è®¾ç½®åœ¨éšæœºå¹¿å‘Šä½ç½®
            // éšæœºé€‰æ‹©ä¸€ä¸ªå¹¿å‘ŠåŒºåŸŸä½œä¸ºåˆå§‹ä½ç½®
            const randomZone = Math.random() > 0.5 ? zone1Center : zone2Center;
            mousePos.x = randomZone.x;
            mousePos.y = randomZone.y;
            
            // æ›´æ–°è‡ªå®šä¹‰å…‰æ ‡ä½ç½®
            customCursor.style.left = `${mousePos.x - 10}px`;
            customCursor.style.top = `${mousePos.y - 10}px`;
            
            // å¢åŠ åˆå§‹æŒ‰é’®åç§»ï¼Œè®©æŒ‰é’®ä¸€å¼€å§‹å°±ä¸åœ¨ä¸­å¿ƒ
            buttonOffset.x = (Math.random() - 0.5) * 20; // éšæœºåç§»-10åˆ°10px
            buttonOffset.y = (Math.random() - 0.5) * 20;
            taskButtonContainer.style.transform = `translate(-50%, -50%) translate(${buttonOffset.x}px, ${buttonOffset.y}px)`;
            
            // æ›´æ–°å¤±è´¥æ¬¡æ•°æ˜¾ç¤º
            updateFailCountDisplay();
            
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                attemptTimer = (Date.now() - startTime) / 1000;
                timerDisplay.textContent = `å°è¯•æ—¶é—´: ${attemptTimer.toFixed(1)}ç§’`;
                
                // æ›´æ–°é˜»åŠ›æŒ‡ç¤ºå™¨
                resistanceIndicator.textContent = `å½“å‰é˜»åŠ›: ${Math.round(currentResistance * 100)}%`;
                if (currentResistance > 0.7) {
                    resistanceIndicator.style.color = '#F44336';
                    resistanceIndicator.style.fontWeight = 'bold';
                } else if (currentResistance > 0.4) {
                    resistanceIndicator.style.color = '#FF9800';
                } else {
                    resistanceIndicator.style.color = '#666';
                }
                
                // æ›´æ–°å¯»æ‰¾æŒ‰é’®æç¤º - ä¿®æ”¹ä¸ºæ›´ç®€æ´çš„æç¤º
                if (canClickButton) {
                    findButtonHint.textContent = "æŒ‰é’®ç¨³å®šï¼ç°åœ¨å¯ä»¥ç‚¹å‡»ï¼";
                    findButtonHint.style.color = "#4CAF50";
                    findButtonHint.style.fontWeight = "bold";
                    findButtonHint.style.background = "rgba(76, 175, 80, 0.2)";
                } else if (buttonFound) {
                    findButtonHint.textContent = "å·²æ‰¾åˆ°æŒ‰é’®ï¼ç­‰å¾…ç¨³å®š...";
                    findButtonHint.style.color = "#FF9800";
                    findButtonHint.style.fontWeight = "bold";
                } else if (isNearButton) {
                    findButtonHint.textContent = "æ¥è¿‘æŒ‰é’®ä¸­...ä¿æŒç¨³å®š";
                    findButtonHint.style.color = "#FF9800";
                } else {
                    findButtonHint.textContent = ""; // æ¸…ç©ºæç¤º
                }
            }, 100);
            
            // å¯åŠ¨åˆ†å¿ƒå€’è®¡æ—¶æ£€æµ‹
            startDistractionDetection();
        }
        
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            stopDistractionDetection();
        }

        // ========== æ›´æ–°å¤±è´¥æ¬¡æ•°æ˜¾ç¤º ==========
        function updateFailCountDisplay() {
            failCountDisplay.textContent = `å¤±è´¥æ¬¡æ•°: ${failCount}`;
            
            // æ ¹æ®å¤±è´¥æ¬¡æ•°æ”¹å˜é¢œè‰²
            if (failCount >= 3) {
                failCountDisplay.style.color = '#F44336';
                failCountDisplay.style.fontWeight = 'bold';
                failCountDisplay.style.background = 'rgba(255, 255, 255, 0.95)';
                failCountDisplay.style.boxShadow = '0 2px 8px rgba(244, 67, 54, 0.4)';
            } else if (failCount >= 2) {
                failCountDisplay.style.color = '#FF9800';
                failCountDisplay.style.fontWeight = 'bold';
                failCountDisplay.style.background = 'rgba(255, 255, 255, 0.9)';
                failCountDisplay.style.boxShadow = '0 2px 6px rgba(255, 152, 0, 0.3)';
            } else if (failCount >= 1) {
                failCountDisplay.style.color = '#FFC107';
                failCountDisplay.style.fontWeight = 'normal';
                failCountDisplay.style.background = 'rgba(255, 255, 255, 0.85)';
                failCountDisplay.style.boxShadow = '0 2px 5px rgba(255, 193, 7, 0.3)';
            } else {
                failCountDisplay.style.color = '#666';
                failCountDisplay.style.fontWeight = 'normal';
                failCountDisplay.style.background = 'rgba(255, 255, 255, 0.8)';
                failCountDisplay.style.boxShadow = '0 2px 5px rgba(0, 0, 0, 0.2)';
            }
        }

        // ========== åˆ†å¿ƒå€’è®¡æ—¶åŠŸèƒ½ ==========
        function startDistractionDetection() {
            if (distractionTimerInterval) clearInterval(distractionTimerInterval);
            
            distractionTimerInterval = setInterval(() => {
                const currentTime = Date.now();
                const timeSinceLastMove = currentTime - lastMouseMoveTime;
                
                // è®¡ç®—å‰©ä½™æ—¶é—´ï¼ˆ1ç§’ï¼‰
                distractionCountdown = Math.max(0, (DISTRACTION_TIMEOUT - timeSinceLastMove) / 1000);
                
                // æ›´æ–°å€’è®¡æ—¶æ˜¾ç¤º - 0.5ç§’åå¼€å§‹æ˜¾ç¤º
                if (timeSinceLastMove > 500) { // 0.5ç§’åå¼€å§‹æ˜¾ç¤º
                    distractionTimer.style.display = 'block';
                    distractionTimer.textContent = `åˆ†å¿ƒå€’è®¡æ—¶: ${distractionCountdown.toFixed(1)}ç§’`;
                    
                    // é¢œè‰²å˜åŒ– - è°ƒæ•´æ—¶é—´é˜ˆå€¼
                    if (distractionCountdown < 0.3) { // æœ€å0.3ç§’å˜çº¢
                        distractionTimer.style.color = '#F44336';
                        distractionTimer.style.background = 'rgba(255, 255, 255, 0.95)';
                    } else if (distractionCountdown < 0.7) { // 0.3-0.7ç§’å˜é»„
                        distractionTimer.style.color = '#FF9800';
                        distractionTimer.style.background = 'rgba(255, 255, 255, 0.9)';
                    } else { // 0.7-1.0ç§’å˜ç»¿
                        distractionTimer.style.color = '#4CAF50';
                        distractionTimer.style.background = 'rgba(255, 255, 255, 0.8)';
                    }
                } else {
                    distractionTimer.style.display = 'none';
                }
                
                // å¦‚æœ1ç§’æ²¡æœ‰ç§»åŠ¨ï¼Œè§¦å‘åˆ†å¿ƒ
                if (timeSinceLastMove >= DISTRACTION_TIMEOUT && !isDistractionActive && isLocked && !isFrozen) {
                    triggerDistraction();
                }
            }, 50); // åŠ å¿«æ£€æµ‹é¢‘ç‡åˆ°50ms
        }
        
        function stopDistractionDetection() {
            if (distractionTimerInterval) {
                clearInterval(distractionTimerInterval);
                distractionTimerInterval = null;
            }
            distractionTimer.style.display = 'none';
        }
        
        function updateMouseMoveTime() {
            lastMouseMoveTime = Date.now();
            isDistractionActive = false;
        }
        
        function triggerDistraction() {
            isDistractionActive = true;
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªå¹¿å‘ŠåŒºåŸŸ
            const randomZone = Math.random() > 0.5 ? zone1Center : zone2Center;
            const targetX = randomZone.x;
            const targetY = randomZone.y;
            
            // æ’­æ”¾åˆ†å¿ƒéŸ³æ•ˆ - æ›´æ€¥ä¿ƒçš„éŸ³æ•ˆ
            if (isAudioEnabled && audioContext) {
                const distractionSound = audioContext.createOscillator();
                const distractionGain = audioContext.createGain();
                
                distractionSound.type = 'triangle';
                distractionSound.frequency.setValueAtTime(400, audioContext.currentTime); // æ›´é«˜é¢‘ç‡
                distractionSound.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.2); // æ›´å¿«ä¸Šå‡
                
                distractionGain.gain.setValueAtTime(0.3, audioContext.currentTime); // æ›´å¤§éŸ³é‡
                distractionGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3); // æ›´å¿«æ·¡å‡º
                
                distractionSound.connect(distractionGain);
                distractionGain.connect(audioContext.destination);
                
                distractionSound.start();
                distractionSound.stop(audioContext.currentTime + 0.3);
            }
            
            // æ·»åŠ åˆ†å¿ƒæç¤º
            const distractionHint = document.createElement('div');
            distractionHint.textContent = "æ³¨æ„åŠ›å¿«é€Ÿåˆ†æ•£ï¼";
            distractionHint.style.position = 'absolute';
            distractionHint.style.top = '200px';
            distractionHint.style.left = '50%';
            distractionHint.style.transform = 'translateX(-50%)';
            distractionHint.style.color = '#FF5722';
            distractionHint.style.fontSize = '14px';
            distractionHint.style.fontWeight = 'bold';
            distractionHint.style.background = 'rgba(255, 255, 255, 0.95)';
            distractionHint.style.padding = '8px 15px';
            distractionHint.style.borderRadius = '8px';
            distractionHint.style.zIndex = '1001';
            distractionHint.style.boxShadow = '0 3px 15px rgba(255, 87, 34, 0.6)';
            body.appendChild(distractionHint);
            
            // å¿«é€Ÿç§»åŠ¨åˆ°å¹¿å‘ŠåŒºåŸŸï¼ˆæ›´å¿«ï¼‰
            const startX = mousePos.x;
            const startY = mousePos.y;
            
            // ç›´æ¥è·³åˆ°å¹¿å‘Šä½ç½®ï¼ˆæ›´çªç„¶ï¼‰
            mousePos.x = targetX;
            mousePos.y = targetY;
            customCursor.style.left = `${mousePos.x - 10}px`;
            customCursor.style.top = `${mousePos.y - 10}px`;
            
            // æ·»åŠ è§†è§‰åé¦ˆ
            customCursor.style.transform = 'scale(1.3)';
            customCursor.style.background = '#FF5722';
            
            // å¿«é€ŸåŠ¨ç”»æ•ˆæœ
            setTimeout(() => {
                customCursor.style.transform = 'scale(1)';
                customCursor.style.background = '#666';
                body.removeChild(distractionHint);
                updateMouseMoveTime(); // é‡ç½®å€’è®¡æ—¶
            }, 300); // 0.3ç§’åæ¢å¤
            
            // ä¸´æ—¶å¢åŠ å¹¿å‘ŠåŒºåŸŸçš„å¸å¼•åŠ›
            const selectedZone = randomZone === zone1Center ? zone1 : zone2;
            selectedZone.style.boxShadow = '0 8px 40px rgba(255, 87, 34, 0.9)';
            selectedZone.style.transform = 'scale(1.15)';
            selectedZone.style.borderColor = '#FF5722';
            
            setTimeout(() => {
                selectedZone.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.4)';
                selectedZone.style.transform = 'scale(1)';
                selectedZone.style.borderColor = '#FF9800';
            }, 800);
        }

        // ========== ä¸­å¿ƒåŒºåŸŸä¿æŒåŠŸèƒ½ ==========
        function startCenterHoldDetection() {
            if (centerHoldInterval) clearInterval(centerHoldInterval);
            
            centerHoldInterval = setInterval(() => {
                if (!isLocked || isFrozen) return;
                
                // è®¡ç®—è·ç¦»ä¸­å¿ƒçš„è·ç¦»
                const distanceToCenter = Math.hypot(mousePos.x - gravityWellCenter.x, mousePos.y - gravityWellCenter.y);
                
                // æ£€æŸ¥æ˜¯å¦åœ¨ä¸­å¿ƒ80pxç›´å¾„èŒƒå›´å†…ï¼ˆåŠå¾„40pxï¼‰
                const nowInCenterZone = distanceToCenter <= CENTER_ZONE_RADIUS;
                
                if (nowInCenterZone && !isInCenterZone) {
                    // åˆšè¿›å…¥ä¸­å¿ƒåŒºåŸŸ
                    isInCenterZone = true;
                    centerHoldStartTime = Date.now();
                    
                    // æ˜¾ç¤ºä¸­å¿ƒæç¤º
                    centerHint.style.display = 'block';
                    centerHint.textContent = "ä¿æŒç¨³å®š...";
                    centerHint.style.color = '#4CAF50';
                } else if (!nowInCenterZone && isInCenterZone) {
                    // ç¦»å¼€ä¸­å¿ƒåŒºåŸŸ
                    isInCenterZone = false;
                    centerHoldStartTime = 0;
                    centerHint.style.display = 'none';
                }
                
                if (isInCenterZone) {
                    // è®¡ç®—å·²ä¿æŒæ—¶é—´
                    const holdTime = Date.now() - centerHoldStartTime;
                    const remainingTime = Math.max(0, CENTER_HOLD_TIME - holdTime);
                    
                    if (remainingTime <= 0) {
                        // ä¿æŒæ—¶é—´è¾¾åˆ°2ç§’ï¼Œè§¦å‘æˆåŠŸ
                        clearInterval(centerHoldInterval);
                        triggerCenterSuccess();
                    } else {
                        // æ›´æ–°æç¤º
                        const secondsRemaining = (remainingTime / 1000).toFixed(1);
                        centerHint.textContent = `${secondsRemaining}s`;
                        
                        // é¢œè‰²æ¸å˜ï¼šä»ç»¿åˆ°é»„åˆ°çº¢
                        if (remainingTime > 1500) { // è¶…è¿‡1.5ç§’æ˜¾ç¤ºç»¿è‰²
                            centerHint.style.color = '#4CAF50';
                        } else if (remainingTime > 800) { // 0.8-1.5ç§’æ˜¾ç¤ºé»„è‰²
                            centerHint.style.color = '#FF9800';
                        } else { // å°‘äº0.8ç§’æ˜¾ç¤ºçº¢è‰²
                            centerHint.style.color = '#F44336';
                        }
                    }
                }
            }, 100);
        }
        
        function stopCenterHoldDetection() {
            if (centerHoldInterval) {
                clearInterval(centerHoldInterval);
                centerHoldInterval = null;
            }
            centerHint.style.display = 'none';
            isInCenterZone = false;
            centerHoldStartTime = 0;
        }
        
        function triggerCenterSuccess() {
            // æ’­æ”¾æˆåŠŸéŸ³æ•ˆ
            if (isAudioEnabled && audioContext) {
                const successOscillator = audioContext.createOscillator();
                const successGain = audioContext.createGain();
                
                successOscillator.type = 'sine';
                successOscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                successOscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                successOscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                
                successGain.gain.setValueAtTime(0, audioContext.currentTime);
                successGain.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                successGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                successOscillator.connect(successGain);
                successGain.connect(audioContext.destination);
                
                successOscillator.start();
                successOscillator.stop(audioContext.currentTime + 0.5);
            }
            
            // æ˜¾ç¤ºæˆåŠŸæç¤º
            centerHint.textContent = "æˆåŠŸï¼";
            centerHint.style.color = '#4CAF50';
            
            // å»¶è¿Ÿè·³è½¬åˆ°ä¸‹ä¸€ç•Œé¢
            setTimeout(() => {
                showTenTasksScreen(); // ç›´æ¥è·³è½¬åˆ°åä»»åŠ¡ç•Œé¢
            }, 1000);
        }

        // ========== Pointer Lock API æ ¸å¿ƒé€»è¾‘ ==========
        // é”å®šé¼ æ ‡
        document.addEventListener('click', () => {
            if (!isLocked) {
                gravityWell.requestPointerLock = gravityWell.requestPointerLock || gravityWell.mozRequestPointerLock;
                gravityWell.requestPointerLock();
                body.classList.add('pointer-locked');
                
                // é¦–æ¬¡ç‚¹å‡»æ—¶åˆå§‹åŒ–éŸ³é¢‘
                if (!audioContext && isAudioEnabled) {
                    initAudio();
                }
                
                // å¼€å§‹è®¡æ—¶
                startTimer();
                // å¯åŠ¨ä¸­å¿ƒåŒºåŸŸä¿æŒæ£€æµ‹
                startCenterHoldDetection();
            }
        });

        // ç›‘å¬é¼ æ ‡é”å®šçŠ¶æ€å˜åŒ–
        document.addEventListener('pointerlockchange', lockChangeHandler, false);
        document.addEventListener('mozpointerlockchange', lockChangeHandler, false);

        function lockChangeHandler() {
            if (document.pointerLockElement === gravityWell || document.mozPointerLockElement === gravityWell) {
                // é¼ æ ‡å·²é”å®šï¼Œç›‘å¬ç›¸å¯¹ç§»åŠ¨äº‹ä»¶
                document.addEventListener('mousemove', handleMouseMove, false);
                isLocked = true;
                // éšè—ä¸­é—´æç¤º
                lockHint.classList.add('hidden');
            } else {
                // é¼ æ ‡è§£é”ï¼Œç§»é™¤ç›‘å¬
                document.removeEventListener('mousemove', handleMouseMove, false);
                body.classList.remove('pointer-locked');
                isLocked = false;
                lockHint.classList.remove('hidden');
                stopCurrentSound();
                stopTimer();
                stopCenterHoldDetection();
            }
        }

        // å¤„ç†é¼ æ ‡ç›¸å¯¹ç§»åŠ¨ï¼šåœ†å½¢é˜»åŠ›åœºè®¡ç®—
        function handleMouseMove(e) {
            if (isFrozen) return;
            
            // æ›´æ–°æœ€åç§»åŠ¨æ—¶é—´
            updateMouseMoveTime();

            // è®¡ç®—ç¦»é‡åŠ›äº•ä¸­å¿ƒçš„è·ç¦»
            const distanceToCenter = Math.hypot(mousePos.x - gravityWellCenter.x, mousePos.y - gravityWellCenter.y);
            
            // è®¡ç®—ç¦»æŒ‰é’®ä¸­å¿ƒçš„è·ç¦»ï¼ˆè€ƒè™‘æŒ‰é’®åç§»ï¼‰
            const buttonCenterX = gravityWellCenter.x + buttonOffset.x;
            const buttonCenterY = gravityWellCenter.y + buttonOffset.y;
            const distanceToButton = Math.hypot(mousePos.x - buttonCenterX, mousePos.y - buttonCenterY);
            
            // åˆ¤æ–­æ˜¯å¦åœ¨é‡åŠ›äº•å†…ï¼ˆè§†è§‰åŒºåŸŸï¼‰
            isInsideGravityWell = distanceToCenter <= GRAVITY_WELL_RADIUS;
            
            // åˆ¤æ–­æ˜¯å¦æ¥è¿‘æŒ‰é’®ï¼ˆä½¿ç”¨æŒ‰é’®çš„å®é™…ä½ç½®ï¼‰
            const effectiveButtonRadius = BUTTON_RADIUS * 1.5; // å¢åŠ æœ‰æ•ˆç‚¹å‡»åŠå¾„
            isNearButton = distanceToButton <= effectiveButtonRadius;
            
            // ========== å¹¿å‘Šå¸å¼•é€»è¾‘ ==========
            let adAttractionForce = 0;
            let activeAdZone = null;
            let activeAdHalo = null;
            
            // è®¡ç®—åˆ°å¹¿å‘ŠåŒºåŸŸæ–¹å½¢è¾¹ç¼˜çš„è·ç¦»ï¼ˆè€Œä¸æ˜¯ä¸­å¿ƒï¼‰
            // å¹¿å‘Šå°ºå¯¸ï¼š180x220pxï¼Œè®¡ç®—åˆ°æ–¹å½¢è¾¹ç•Œæ¡†çš„è·ç¦»
            let distanceToZone1 = 0;
            let distanceToZone2 = 0;
            
            // è®¡ç®—åˆ°zone1æ–¹å½¢è¾¹ç¼˜çš„è·ç¦»
            const zone1Left = zone1Rect.left;
            const zone1Right = zone1Rect.right;
            const zone1Top = zone1Rect.top;
            const zone1Bottom = zone1Rect.bottom;
            
            // æ‰©å±•è¾¹ç•Œæ¡†ï¼šå‘å¤–æ‰©å±•100px
            const zone1ExtendedLeft = zone1Left - 100;
            const zone1ExtendedRight = zone1Right + 100;
            const zone1ExtendedTop = zone1Top - 100;
            const zone1ExtendedBottom = zone1Bottom + 100;
            
            // æ£€æŸ¥é¼ æ ‡æ˜¯å¦åœ¨æ‰©å±•çš„æ–¹å½¢åŒºåŸŸå†…
            const isInZone1Extended = mousePos.x >= zone1ExtendedLeft && 
                                     mousePos.x <= zone1ExtendedRight && 
                                     mousePos.y >= zone1ExtendedTop && 
                                     mousePos.y <= zone1ExtendedBottom;
            
            if (isInZone1Extended) {
                // è®¡ç®—åˆ°æœ€è¿‘è¾¹ç¼˜çš„è·ç¦»
                const distToLeft = Math.abs(mousePos.x - zone1ExtendedLeft);
                const distToRight = Math.abs(mousePos.x - zone1ExtendedRight);
                const distToTop = Math.abs(mousePos.y - zone1ExtendedTop);
                const distToBottom = Math.abs(mousePos.y - zone1ExtendedBottom);
                
                // å–åˆ°æœ€è¿‘è¾¹ç¼˜çš„è·ç¦»
                distanceToZone1 = Math.min(distToLeft, distToRight, distToTop, distToBottom);
                
                // è½¬æ¢ä¸ºè·ç¦»å¹¿å‘ŠåŒºåŸŸçš„è·ç¦»ï¼ˆ0-100pxï¼‰
                distanceToZone1 = 100 - distanceToZone1;
            }
            
            // è®¡ç®—åˆ°zone2æ–¹å½¢è¾¹ç¼˜çš„è·ç¦»
            const zone2Left = zone2Rect.left;
            const zone2Right = zone2Rect.right;
            const zone2Top = zone2Rect.top;
            const zone2Bottom = zone2Rect.bottom;
            
            // æ‰©å±•è¾¹ç•Œæ¡†ï¼šå‘å¤–æ‰©å±•100px
            const zone2ExtendedLeft = zone2Left - 100;
            const zone2ExtendedRight = zone2Right + 100;
            const zone2ExtendedTop = zone2Top - 100;
            const zone2ExtendedBottom = zone2Bottom + 100;
            
            // æ£€æŸ¥é¼ æ ‡æ˜¯å¦åœ¨æ‰©å±•çš„æ–¹å½¢åŒºåŸŸå†…
            const isInZone2Extended = mousePos.x >= zone2ExtendedLeft && 
                                     mousePos.x <= zone2ExtendedRight && 
                                     mousePos.y >= zone2ExtendedTop && 
                                     mousePos.y <= zone2ExtendedBottom;
            
            if (isInZone2Extended) {
                // è®¡ç®—åˆ°æœ€è¿‘è¾¹ç¼˜çš„è·ç¦»
                const distToLeft = Math.abs(mousePos.x - zone2ExtendedLeft);
                const distToRight = Math.abs(mousePos.x - zone2ExtendedRight);
                const distToTop = Math.abs(mousePos.y - zone2ExtendedTop);
                const distToBottom = Math.abs(mousePos.y - zone2ExtendedBottom);
                
                // å–åˆ°æœ€è¿‘è¾¹ç¼˜çš„è·ç¦»
                distanceToZone2 = Math.min(distToLeft, distToRight, distToTop, distToBottom);
                
                // è½¬æ¢ä¸ºè·ç¦»å¹¿å‘ŠåŒºåŸŸçš„è·ç¦»ï¼ˆ0-100pxï¼‰
                distanceToZone2 = 100 - distanceToZone2;
            }
            
            // ç¡®å®šå“ªä¸ªå¹¿å‘ŠåŒºåŸŸæ›´è¿‘
            let nearestAdDistance = 0;
            if (distanceToZone1 > 0 && distanceToZone2 > 0) {
                nearestAdDistance = Math.max(distanceToZone1, distanceToZone2); // å–æ›´é è¿‘çš„
            } else if (distanceToZone1 > 0) {
                nearestAdDistance = distanceToZone1;
            } else if (distanceToZone2 > 0) {
                nearestAdDistance = distanceToZone2;
            }
            
            if (nearestAdDistance > 0) {
                // è®¡ç®—å¸å¼•åŠ›çš„å¼ºåº¦ - åŸºäºåˆ°æ–¹å½¢è¾¹ç¼˜çš„è·ç¦»ï¼ˆ0-100pxï¼‰
                adAttractionForce = nearestAdDistance / 100; // 0-1çš„å¼ºåº¦
                adAttractionForce = adAttractionForce * AD_ATTRACTION_FORCE; // åº”ç”¨åŸºç¡€å¸å¼•åŠ›ç³»æ•°
                
                // ç¡®å®šå“ªä¸ªå¹¿å‘ŠåŒºåŸŸæ˜¯æ¿€æ´»çš„
                if (distanceToZone1 >= distanceToZone2 && distanceToZone1 > 0) {
                    activeAdZone = zone1;
                    activeAdHalo = halo1;
                } else if (distanceToZone2 > 0) {
                    activeAdZone = zone2;
                    activeAdHalo = halo2;
                }
                
                // æ˜¾ç¤ºæ¿€æ´»å¹¿å‘Šçš„å…‰ç¯
                if (activeAdHalo) {
                    activeAdHalo.style.display = 'block';
                    // æ ¹æ®å¸å¼•åŠ›å¼ºåº¦è°ƒæ•´å…‰ç¯é€æ˜åº¦
                    const haloOpacity = 0.05 + (adAttractionForce * 2);
                    activeAdHalo.style.opacity = Math.min(0.15, haloOpacity);
                }
                
                // éšè—å¦ä¸€ä¸ªå¹¿å‘Šçš„å…‰ç¯
                if (activeAdHalo === halo1 && halo2) {
                    halo2.style.display = 'none';
                } else if (activeAdHalo === halo2 && halo1) {
                    halo1.style.display = 'none';
                }
                
                // æ’­æ”¾å¹¿å‘Šå¸å¼•éŸ³æ•ˆï¼ˆä½é¢‘å—¡å—¡å£°ï¼‰
                if (isAudioEnabled && audioContext && adAttractionForce > 0.03) {
                    // åˆ›å»ºä½é¢‘å—¡å—¡å£°
                    const adSound = audioContext.createOscillator();
                    const adGain = audioContext.createGain();
                    
                    adSound.type = 'sine';
                    adSound.frequency.setValueAtTime(120 + (adAttractionForce * 80), audioContext.currentTime); // 120-200Hz
                    
                    adGain.gain.setValueAtTime(adAttractionForce * 0.1, audioContext.currentTime);
                    
                    adSound.connect(adGain);
                    adGain.connect(audioContext.destination);
                    
                    adSound.start();
                    adSound.stop(audioContext.currentTime + 0.1);
                }
                
                // è§†è§‰åé¦ˆï¼šå…‰æ ‡è½»å¾®å˜åŒ–
                customCursor.style.transform = `scale(${1 + adAttractionForce * 0.2})`;
                if (activeAdZone === zone1) {
                    customCursor.style.background = '#2196F3';
                } else {
                    customCursor.style.background = '#E91E63';
                }
            } else {
                // é¼ æ ‡ä¸åœ¨å¹¿å‘Šå¸å¼•èŒƒå›´å†…ï¼Œéšè—æ‰€æœ‰å…‰ç¯
                halo1.style.display = 'none';
                halo2.style.display = 'none';
            }
            
            // ========== æ ¸å¿ƒå·¥ä½œåŒºé˜»åŠ›è®¡ç®— ==========
            // æ ¹æ®åŒºåŸŸè®¡ç®—é˜»åŠ›ï¼ˆåœ†å½¢æ¢¯åº¦é˜»åŠ›ï¼‰
            let resistance = 0;
            let zoneType = 'outside';
            
            if (distanceToCenter <= HIGH_RESISTANCE_RADIUS) {
                // é«˜é˜»åŠ›åŒºåŸŸï¼šç»Ÿä¸€80%é˜»åŠ›ï¼ˆä»0pxåˆ°200pxï¼‰
                resistance = 0.8; // ç»Ÿä¸€80%é˜»åŠ›
                zoneType = 'high';
                isInCoreZone = true;
                
                // åœ¨é«˜é˜»åŠ›åŒºä½†æ¥è¿‘æŒ‰é’®æ—¶å¢åŠ è§†è§‰åé¦ˆ
                if (isNearButton) {
                    buttonFound = true;
                    // æŒ‰é’®å‘å…‰æ•ˆæœå¢å¼º
                    taskBtn.style.boxShadow = `0 0 25px rgba(255, 255, 100, 0.6), inset 0 0 12px rgba(255, 255, 255, 0.25)`;
                    buttonHalo.style.opacity = '0.4';
                }
            } else if (distanceToCenter <= MEDIUM_RESISTANCE_RADIUS) {
                // ä¸­ç­‰é˜»åŠ›åŒºåŸŸï¼š50-70%é˜»åŠ›ï¼ˆä»200pxåˆ°300pxï¼‰
                const normalized = (distanceToCenter - HIGH_RESISTANCE_RADIUS) / (MEDIUM_RESISTANCE_RADIUS - HIGH_RESISTANCE_RADIUS);
                resistance = 0.7 - (normalized * 0.2); // 70-50%é˜»åŠ›
                zoneType = 'medium';
                isInCoreZone = false;
            } else if (distanceToCenter <= LOW_RESISTANCE_RADIUS) {
                // ä½é˜»åŠ›åŒºåŸŸï¼š30-50%é˜»åŠ›ï¼ˆä»300pxåˆ°350pxï¼‰
                const normalized = (distanceToCenter - MEDIUM_RESISTANCE_RADIUS) / (LOW_RESISTANCE_RADIUS - MEDIUM_RESISTANCE_RADIUS);
                resistance = 0.5 - (normalized * 0.2); // 50-30%é˜»åŠ›
                zoneType = 'low';
                isInCoreZone = false;
            } else if (distanceToCenter <= RESISTANCE_AREA_RADIUS) {
                // è½»å¾®é˜»åŠ›åŒºåŸŸï¼š10-30%é˜»åŠ›ï¼ˆä»350pxåˆ°400pxï¼‰
                const normalized = (distanceToCenter - LOW_RESISTANCE_RADIUS) / (RESISTANCE_AREA_RADIUS - LOW_RESISTANCE_RADIUS);
                resistance = 0.3 - (normalized * 0.2); // 30-10%é˜»åŠ›
                zoneType = 'verylow';
                isInCoreZone = false;
            } else {
                // é˜»åŠ›åŒºåŸŸå¤–ï¼šæ— é˜»åŠ›
                resistance = 0;
                zoneType = 'outside';
                isInCoreZone = false;
            }
            
            currentResistance = resistance;
            
            // ========== åº”ç”¨é˜»åŠ›å’Œå¸å¼•åŠ› ==========
            // åº”ç”¨é˜»åŠ›ï¼šé¼ æ ‡å®é™…ç§»åŠ¨è·ç¦» = åŸå§‹ç§»åŠ¨è·ç¦» Ã— (1 - é˜»åŠ›)
            const moveX = e.movementX * (1 - resistance);
            const moveY = e.movementY * (1 - resistance);
            
            // ========== å…‹æœé˜»åŠ›æ¶ˆè€—èƒ½é‡ ==========
            // è®¡ç®—å…‹æœé˜»åŠ›æ‰€éœ€çš„èƒ½é‡ï¼ˆåŸºäºç§»åŠ¨è·ç¦»å’Œé˜»åŠ›å¤§å°ï¼‰
            if (resistance > 0) {
                const movementMagnitude = Math.sqrt(e.movementX * e.movementX + e.movementY * e.movementY);
                if (movementMagnitude > 0) {
                    // èƒ½é‡æ¶ˆè€— = ç§»åŠ¨è·ç¦» Ã— é˜»åŠ› Ã— é˜»åŠ›èƒ½é‡æ¶ˆè€—å€å¢å™¨
                    const resistanceEnergyCost = movementMagnitude * resistance * RESISTANCE_ENERGY_COST_MULTIPLIER * 0.01;
                    
                    // å‡å°‘èƒ½é‡
                    reduceEnergy(resistanceEnergyCost);
                    
                    // è§†è§‰åé¦ˆï¼šæ ¹æ®èƒ½é‡æ¶ˆè€—ç¨‹åº¦æ”¹å˜å…‰æ ‡é¢œè‰²
                    if (resistanceEnergyCost > 0.5) {
                        const intensity = Math.min(1, resistanceEnergyCost / 2);
                        customCursor.style.background = `rgb(${200 + Math.floor(55 * intensity)}, ${160 - Math.floor(100 * intensity)}, ${120 - Math.floor(70 * intensity)})`;
                    }
                }
            }
            
            // åº”ç”¨å¹¿å‘Šå¸å¼•åŠ›ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (adAttractionForce > 0 && activeAdZone) {
                // è®¡ç®—å‘å¹¿å‘Šä¸­å¿ƒçš„æ–¹å‘ï¼ˆä»è¾¹ç¼˜å‘ä¸­å¿ƒå¸å¼•ï¼‰
                let targetCenter;
                if (activeAdZone === zone1) {
                    targetCenter = zone1Center;
                } else {
                    targetCenter = zone2Center;
                }
                
                const angleToAd = Math.atan2(targetCenter.y - mousePos.y, targetCenter.x - mousePos.x);
                
                // å‘å¹¿å‘Šæ–¹å‘æ–½åŠ å¸å¼•åŠ›
                const attractionStrength = adAttractionForce * 30; // å¸å¼•åŠ›å¼ºåº¦
                const attractionX = Math.cos(angleToAd) * attractionStrength;
                const attractionY = Math.sin(angleToAd) * attractionStrength;
                
                // æ›´æ–°é¼ æ ‡ä½ç½®ï¼ˆé˜»åŠ› + å¸å¼•åŠ›ï¼‰
                mousePos.x += moveX + attractionX;
                mousePos.y += moveY + attractionY;
                
                // å¹¿å‘ŠåŒºåŸŸå¢å¼ºæ•ˆæœ
                const adScale = 1 + adAttractionForce * 0.05;
                const adShadowIntensity = 25 + (adAttractionForce * 20);
                
                if (activeAdZone === zone1) {
                    activeAdZone.style.boxShadow = `0 8px ${adShadowIntensity}px rgba(33, 150, 243, 0.7)`;
                } else {
                    activeAdZone.style.boxShadow = `0 8px ${adShadowIntensity}px rgba(233, 30, 99, 0.7)`;
                }
                activeAdZone.style.transform = `scale(${adScale})`;
                
                // ========== ä¿®æ”¹ï¼šé€ƒç¦»å¹¿å‘Šå¸å¼•åŠ›æ¶ˆè€—èƒ½é‡ï¼ˆé™ä½åˆ°2å€ï¼‰ ==========
                // è®¡ç®—ç”¨æˆ·æŠµæŠ—å¹¿å‘Šå¸å¼•åŠ›çš„ç¨‹åº¦
                // å¦‚æœç”¨æˆ·è¯•å›¾è¿œç¦»å¹¿å‘Šï¼ˆç§»åŠ¨æ–¹å‘ä¸å¸å¼•åŠ›æ–¹å‘ç›¸åï¼‰ï¼Œåˆ™æ¶ˆè€—èƒ½é‡
                const userMoveAngle = Math.atan2(e.movementY, e.movementX);
                const angleDifference = Math.abs(angleToAd - userMoveAngle);
                
                // å½“ç”¨æˆ·ç§»åŠ¨æ–¹å‘ä¸å¸å¼•åŠ›æ–¹å‘ç›¸åï¼ˆå°è¯•é€ƒç¦»ï¼‰æ—¶æ¶ˆè€—èƒ½é‡
                if (angleDifference > Math.PI/2) {
                    // è®¡ç®—æŠµæŠ—å¼ºåº¦ï¼šè§’åº¦å·®è¶Šå¤§ï¼ŒæŠµæŠ—è¶Šå¼ºçƒˆ
                    const resistanceStrength = Math.min(1, (angleDifference - Math.PI/2) / (Math.PI/2));
                    
                    // èƒ½é‡æ¶ˆè€—åŸºäºå¹¿å‘Šå¸å¼•åŠ›å¼ºåº¦å’Œç”¨æˆ·æŠµæŠ—å¼ºåº¦ - ä½¿ç”¨2.0å€å€å¢å™¨
                    const energyCost = adAttractionForce * resistanceStrength * AD_ESCAPE_ENERGY_COST_MULTIPLIER; // 2.0å€èƒ½é‡æ¶ˆè€—
                    
                    // å‡å°‘èƒ½é‡
                    reduceEnergy(energyCost);
                    
                    // è§†è§‰åé¦ˆï¼šå…‰æ ‡é—ªçƒçº¢è‰²
                    customCursor.style.animation = 'none'; // æ¸…é™¤ç°æœ‰åŠ¨ç”»
                    setTimeout(() => {
                        customCursor.style.animation = 'cursorResist 0.3s';
                    }, 10);
                    
                    // éŸ³é¢‘åé¦ˆï¼šæ’­æ”¾æŠµæŠ—éŸ³æ•ˆ
                    if (isAudioEnabled && audioContext) {
                        const resistSound = audioContext.createOscillator();
                        const resistGain = audioContext.createGain();
                        
                        resistSound.type = 'sawtooth';
                        resistSound.frequency.setValueAtTime(200 + (resistanceStrength * 300), audioContext.currentTime); // æ›´é«˜é¢‘ç‡
                        
                        resistGain.gain.setValueAtTime(resistanceStrength * 0.15, audioContext.currentTime); // æ›´å¤§éŸ³é‡
                        resistGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                        
                        resistSound.connect(resistGain);
                        resistGain.connect(audioContext.destination);
                        
                        resistSound.start();
                        resistSound.stop(audioContext.currentTime + 0.2);
                    }
                }
                
            } else {
                // åªåº”ç”¨é˜»åŠ›ï¼Œæ²¡æœ‰å¸å¼•åŠ›
                mousePos.x += moveX;
                mousePos.y += moveY;
                
                // æ¢å¤å¹¿å‘ŠåŒºåŸŸæ ·å¼
                zone1.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.4)';
                zone1.style.transform = 'scale(1)';
                zone2.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.4)';
                zone2.style.transform = 'scale(1)';
                
                // æ¢å¤å…‰æ ‡æ ·å¼ï¼ˆä»…åœ¨ä¸åœ¨å¹¿å‘Šå¸å¼•èŒƒå›´å†…ä¸”ä¸åœ¨æŒ‰é’®é™„è¿‘æ—¶ï¼‰
                if (!isInCoreZone || !isNearButton) {
                    customCursor.style.transform = 'scale(1)';
                    customCursor.style.background = '#666';
                }
                
                // èƒ½é‡æ¢å¤ï¼ˆæ ¹æ®åŒºåŸŸä¸åŒæ¢å¤é€Ÿåº¦ä¸åŒï¼‰- ç•¥å¾®é™ä½æ¢å¤é€Ÿåº¦ä»¥å¹³è¡¡å¢åŠ çš„èƒ½é‡æ¶ˆè€—
                let recoveryRate = 0.10; // é»˜è®¤æ¢å¤é€Ÿåº¦ç•¥å¾®é™ä½
                if (zoneType === 'high') recoveryRate = 0.02;
                else if (zoneType === 'medium') recoveryRate = 0.04;
                else if (zoneType === 'low') recoveryRate = 0.07;
                else if (zoneType === 'verylow') recoveryRate = 0.12;
                else if (zoneType === 'outside') recoveryRate = 0.15;
                
                restoreEnergy(recoveryRate);
            }

            // æ›´æ–°è‡ªå®šä¹‰å…‰æ ‡ä½ç½®
            customCursor.style.left = `${mousePos.x - 10}px`;
            customCursor.style.top = `${mousePos.y - 10}px`;

            // é«˜é˜»åŠ›åŒºåŸŸä¸”æ¥è¿‘æŒ‰é’®çš„åˆ¤å®š
            if (isInCoreZone && isNearButton) {
                // è®¡ç®—æ¥è¿‘å¼ºåº¦ï¼ˆåŸºäºè·ç¦»æŒ‰é’®çš„æ¯”ä¾‹ï¼‰
                const repulsionForce = 1 - (distanceToButton / (effectiveButtonRadius * 1.2));
                
                // è®°å½•å¼€å§‹æ¶ˆè€—èƒ½é‡çš„æ—¶é—´
                if (energyDepletionStartTime === 0) {
                    energyDepletionStartTime = Date.now();
                }
                
                // ç´¯ç§¯åœ¨æŒ‰é’®é™„è¿‘çš„æ—¶é—´
                timeNearButton += 0.016;
                
                // æ’­æ”¾Web Audioç”Ÿæˆçš„ç”µæµå£°
                if (isAudioEnabled) {
                    playCurrentSound(repulsionForce);
                }
                
                // è§†è§‰åé¦ˆï¼šå…‰æ ‡å˜åŒ–ï¼ˆè¦†ç›–å¹¿å‘Šå¸å¼•æ•ˆæœï¼‰
                customCursor.style.transform = `scale(${1 + repulsionForce * 1.5})`; // å‡å°ç¼©æ”¾å¹…åº¦
                customCursor.style.opacity = `${0.8 - repulsionForce * 0.3}`; // å¢åŠ åŸºç¡€é€æ˜åº¦
                customCursor.style.background = `rgb(${Math.floor(200 - repulsionForce * 80)}, ${Math.floor(160 - repulsionForce * 80)}, ${Math.floor(120 - repulsionForce * 50)})`;
                
                // å¢åŠ æŒ‰é’®æŠ–åŠ¨å¹…åº¦ - æé«˜éš¾åº¦
                const shakeAmount = 15; // å¢åŠ æŠ–åŠ¨å¹…åº¦ï¼ˆåŸ8ï¼‰
                const xShake = (Math.random() - 0.5) * 2 * shakeAmount * repulsionForce;
                const yShake = (Math.random() - 0.5) * 2 * shakeAmount * repulsionForce;
                
                // å‡å°‘å¹³æ»‘åº¦ï¼Œä½¿æŠ–åŠ¨æ›´å‰§çƒˆ
                buttonOffset.x = buttonOffset.x * 0.7 + xShake * 0.3; // åŸ0.8 + 0.2
                buttonOffset.y = buttonOffset.y * 0.7 + yShake * 0.3;
                
                // åº”ç”¨æŒ‰é’®åç§»
                taskButtonContainer.style.transform = `translate(-50%, -50%) translate(${buttonOffset.x}px, ${buttonOffset.y}px)`;
                
                // æ£€æŸ¥æŒ‰é’®æ˜¯å¦ç¨³å®šï¼ˆæé«˜éš¾åº¦ï¼Œé˜ˆå€¼æ›´ä½ï¼‰
                const totalShake = Math.abs(buttonOffset.x) + Math.abs(buttonOffset.y);
                canClickButton = totalShake < 3; // é™ä½ç¨³å®šé˜ˆå€¼åˆ°3pxï¼ˆåŸ5pxï¼‰
                
                if (canClickButton) {
                    // æŒ‰é’®ç¨³å®šæ—¶çš„è§†è§‰åé¦ˆ
                    taskBtn.style.boxShadow = `0 0 30px rgba(76, 175, 80, 0.8), inset 0 0 15px rgba(255, 255, 255, 0.3)`;
                    taskBtn.style.background = 'radial-gradient(circle at center, #4CAF50 0%, #388E3C 100%)';
                }
                
                // å…‰ç¯å‘å…‰æ•ˆæœ
                buttonHalo.style.boxShadow = `0 0 ${12 + repulsionForce * 18}px rgba(255, 100, 100, ${0.3 + repulsionForce * 0.25})`;
                
                // è®¡ç®—èƒ½é‡æ¶ˆè€— - å¢åŠ æŒ‰é’®é™„è¿‘çš„èƒ½é‡æ¶ˆè€—
                const timeInZone = (Date.now() - energyDepletionStartTime) / 1000;
                // å‡å°‘åˆ°4ç§’è€—å°½ï¼Œå¢åŠ èƒ½é‡æ¶ˆè€—ï¼ˆæé«˜éš¾åº¦ï¼‰
                const targetEnergy = Math.max(0, 100 - (timeInZone / 4) * 100); // 4ç§’è€—å°½ï¼ˆåŸ5ç§’ï¼‰
                const energyDiff = energy - targetEnergy;
                
                if (energyDiff > 0) {
                    // åº”ç”¨æŒ‰é’®æ’æ–¥èƒ½é‡æ¶ˆè€—å€å¢å™¨
                    reduceEnergy(energyDiff * BUTTON_REPULSION_ENERGY_COST_MULTIPLIER);
                }
                
                // å¢å¼ºçš„æ ¸å¿ƒåŒºåŸŸæ’æ–¥åŠ›ï¼ˆå‘å¤–æ¨ï¼‰ - å¢åŠ æ’æ–¥åŠ›
                if (distanceToButton < BUTTON_RADIUS) {
                    const pushForce = 0.25 + repulsionForce * 0.35; // å¢åŠ æ’æ–¥åŠ›ï¼ˆåŸ0.15 + 0.25ï¼‰
                    const angleToCenter = Math.atan2(mousePos.y - buttonCenterY, mousePos.x - buttonCenterX);
                    
                    // æ·»åŠ éšæœºè§’åº¦åç§»
                    const randomAngleOffset = (Math.random() - 0.5) * 0.5; // å¢åŠ éšæœºè§’åº¦åç§»ï¼ˆåŸ0.3ï¼‰
                    const finalAngle = angleToCenter + randomAngleOffset;
                    
                    // å‘å¤–æ¨ - å¢åŠ å¹…åº¦
                    mousePos.x += Math.cos(finalAngle) * pushForce * 25; // å¢åŠ åˆ°25ï¼ˆåŸ15ï¼‰
                    mousePos.y += Math.sin(finalAngle) * pushForce * 25;
                    
                    // æ·»åŠ é¢å¤–çš„éšæœºæ¨ªå‘æŠ–åŠ¨ - å¢åŠ å¹…åº¦
                    mousePos.x += (Math.random() - 0.5) * pushForce * 12;
                    mousePos.y += (Math.random() - 0.5) * pushForce * 12;
                }
                
            } else if (!adAttractionForce) {
                // é‡ç½®èƒ½é‡æ¶ˆè€—è®¡æ—¶ï¼ˆä»…åœ¨ä¸åœ¨å¹¿å‘Šå¸å¼•èŒƒå›´å†…æ—¶ï¼‰
                energyDepletionStartTime = 0;
                buttonFound = false;
                canClickButton = false;
                
                // åœæ­¢ç”µæµå£°
                if (isAudioEnabled) {
                    stopCurrentSound();
                }
                
                // æ¢å¤å…‰æ ‡æ ·å¼ï¼ˆä»…åœ¨ä¸åœ¨å¹¿å‘Šå¸å¼•èŒƒå›´å†…ä¸”ä¸åœ¨æŒ‰é’®é™„è¿‘æ—¶ï¼‰
                if (!adAttractionForce && (!isInCoreZone || !isNearButton)) {
                    customCursor.style.transform = 'scale(1)';
                    customCursor.style.opacity = '1';
                    customCursor.style.background = '#666';
                }
                
                // å‡å°å¤ä½é€Ÿåº¦ï¼Œä½¿æŒ‰é’®æ›´éš¾å›åˆ°ä¸­å¿ƒ
                buttonOffset.x *= 0.85; // åŸ0.9
                buttonOffset.y *= 0.85; // åŸ0.9
                taskButtonContainer.style.transform = `translate(-50%, -50%) translate(${buttonOffset.x}px, ${buttonOffset.y}px)`;
                
                // æ¢å¤æŒ‰é’®æ ·å¼
                taskBtn.style.boxShadow = '0 0 15px rgba(0, 0, 0, 0.6), inset 0 0 8px rgba(255, 255, 255, 0.15)';
                taskBtn.style.background = 'radial-gradient(circle at center, #333 0%, #222 100%)';
                buttonHalo.style.boxShadow = 'none';
                buttonHalo.style.opacity = '0.25';
                
                // èƒ½é‡æ¢å¤ï¼ˆæ ¹æ®åŒºåŸŸä¸åŒæ¢å¤é€Ÿåº¦ä¸åŒï¼‰- ç•¥å¾®é™ä½æ¢å¤é€Ÿåº¦
                let recoveryRate = 0.10; // é»˜è®¤æ¢å¤é€Ÿåº¦ç•¥å¾®é™ä½
                if (zoneType === 'high') recoveryRate = 0.02;
                else if (zoneType === 'medium') recoveryRate = 0.04;
                else if (zoneType === 'low') recoveryRate = 0.07;
                else if (zoneType === 'verylow') recoveryRate = 0.12;
                else if (zoneType === 'outside') recoveryRate = 0.15;
                
                restoreEnergy(recoveryRate);
            }

            // èƒ½é‡è€—å°½åˆ¤å®š - ç›´æ¥è·³è½¬åˆ°è¯Šæ–­é¡µé¢
            if (energy <= 0 && !isFrozen) {
                isFrozen = true;
                customCursor.style.background = '#f00';
                
                // æ’­æ”¾èƒ½é‡è€—å°½çš„ç‰¹æ®Šå£°éŸ³
                if (isAudioEnabled && audioContext) {
                    // åˆ›å»ºçŸ­æš‚çš„é«˜é¢‘å°–å•¸å£°
                    const screamOscillator = audioContext.createOscillator();
                    const screamGain = audioContext.createGain();
                    
                    screamOscillator.type = 'sine';
                    screamOscillator.frequency.setValueAtTime(1000, audioContext.currentTime);
                    screamOscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 1.5);
                    
                    screamGain.gain.setValueAtTime(0.5, audioContext.currentTime);
                    screamGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
                    
                    screamOscillator.connect(screamGain);
                    screamGain.connect(audioContext.destination);
                    
                    screamOscillator.start();
                    screamOscillator.stop(audioContext.currentTime + 1.5);
                }
                
                // çŸ­æš‚å»¶è¿Ÿåæ˜¾ç¤ºè¯Šæ–­é¡µé¢
                setTimeout(() => {
                    triggerDiagnosisOverlay();
                }, 500);
            }
        }

        // ========== æŒ‰é’®ç‚¹å‡»åˆ¤å®š ==========
        taskBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            
            if (isFrozen) return;
            
            // è®¡ç®—æŒ‰é’®çš„å®é™…ä½ç½®
            const buttonCenterX = gravityWellCenter.x + buttonOffset.x;
            const buttonCenterY = gravityWellCenter.y + buttonOffset.y;
            const distanceToButton = Math.hypot(mousePos.x - buttonCenterX, mousePos.y - buttonCenterY);
            
            // åˆ¤æ–­æ˜¯å¦åœ¨å¯ç‚¹å‡»èŒƒå›´å†…ï¼ˆæé«˜éš¾åº¦ï¼Œç¼©å°æœ‰æ•ˆç‚¹å‡»èŒƒå›´ï¼‰
            const isMouseOverButton = distanceToButton <= BUTTON_RADIUS * 1.1; // ç¼©å°æœ‰æ•ˆç‚¹å‡»èŒƒå›´ï¼ˆåŸ1.2ï¼‰
            
            if (isMouseOverButton && isInCoreZone && canClickButton) {
                // åœ¨é«˜é˜»åŠ›åŒºã€æ¥è¿‘æŒ‰é’®ä¸”æŒ‰é’®ç¨³å®šæ—¶ç‚¹å‡» - æ’­æ”¾æˆåŠŸéŸ³æ•ˆ
                if (isAudioEnabled && audioContext) {
                    const successOscillator = audioContext.createOscillator();
                    const successGain = audioContext.createGain();
                    
                    successOscillator.type = 'sine';
                    successOscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                    successOscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                    successOscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
                    
                    successGain.gain.setValueAtTime(0, audioContext.currentTime);
                    successGain.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                    successGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    successOscillator.connect(successGain);
                    successGain.connect(audioContext.destination);
                    
                    successOscillator.start();
                    successOscillator.stop(audioContext.currentTime + 0.5);
                }
                
                // ========== ä¿®å¤ï¼šç›´æ¥è·³è½¬åˆ°åä»»åŠ¡ç•Œé¢ ==========
                setTimeout(() => {
                    showTenTasksScreen(); // ç›´æ¥è·³è½¬åˆ°åä»»åŠ¡ç•Œé¢ï¼Œè€Œä¸æ˜¯æˆåŠŸç•Œé¢
                }, 500);
            } else {
                // ========== è®°å½•å¤±è´¥æ¬¡æ•° ==========
                failCount++;
                
                // æ›´æ–°å¤±è´¥æ¬¡æ•°æ˜¾ç¤º
                updateFailCountDisplay();
                
                // æ˜¾ç¤ºç‚¹å‡»å¤±è´¥æç¤º
                const failHint = document.createElement('div');
                failHint.textContent = `ç‚¹å‡»å¤±è´¥ï¼æŒ‰é’®ä¸ç¨³å®š (å¤±è´¥æ¬¡æ•°: ${failCount})`;
                failHint.style.position = 'absolute';
                failHint.style.top = '200px';
                failHint.style.left = '50%';
                failHint.style.transform = 'translateX(-50%)';
                failHint.style.color = '#F44336';
                failHint.style.fontSize = '14px';
                failHint.style.fontWeight = 'bold';
                failHint.style.background = 'rgba(255, 255, 255, 0.95)';
                failHint.style.padding = '8px 15px';
                failHint.style.borderRadius = '8px';
                failHint.style.zIndex = '1001';
                failHint.style.boxShadow = '0 3px 15px rgba(244, 67, 54, 0.6)';
                body.appendChild(failHint);
                
                setTimeout(() => {
                    body.removeChild(failHint);
                }, 1000);
                
                // æ’­æ”¾å¤±è´¥éŸ³æ•ˆ
                if (isAudioEnabled && audioContext) {
                    const failSound = audioContext.createOscillator();
                    const failGain = audioContext.createGain();
                    
                    failSound.type = 'sawtooth';
                    failSound.frequency.setValueAtTime(200, audioContext.currentTime);
                    failSound.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.3);
                    
                    failGain.gain.setValueAtTime(0.2, audioContext.currentTime);
                    failGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    failSound.connect(failGain);
                    failGain.connect(audioContext.destination);
                    
                    failSound.start();
                    failSound.stop(audioContext.currentTime + 0.3);
                }
                
                if (failCount >= 3) {
                    // 3æ¬¡å¤±è´¥åç›´æ¥è·³è½¬åˆ°è¯Šæ–­é¡µé¢
                    setTimeout(() => {
                        triggerDiagnosisOverlay();
                    }, 500);
                }
            }
        });

        // ========== æ˜¾ç¤ºåä»»åŠ¡åˆ†æ•£å¸ƒå±€ç•Œé¢ ==========
        function showTenTasksScreen() {
            isFrozen = true;
            stopCurrentSound();
            stopTimer();
            stopCenterHoldDetection();
            
            // è§£é”é¼ æ ‡
            document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock;
            document.exitPointerLock();
            
            // éšè—æ‰€æœ‰ç¬¬ä¸€ç•Œé¢çš„å…ƒç´ 
            document.querySelectorAll('.gravity-well, .entertainment-zones, .energy-bar, .energy-value, .timer-display, .resistance-indicator, .find-button-hint, .distraction-timer, .button-instruction, .audio-control, .custom-cursor, .lock-hint, .audio-hint, .center-hint, .fail-count-display').forEach(el => {
                el.style.display = 'none';
            });
            
            // éšè—æˆåŠŸç•Œé¢
            successScreen.style.display = 'none';
            
            // æ˜¾ç¤ºåä»»åŠ¡ç•Œé¢
            tenTasksScreen.style.display = 'flex';
            
            // éšè—é»˜è®¤å…‰æ ‡ï¼Œæ˜¾ç¤ºçº¢è‰²åœ†ç‚¹å…‰æ ‡
            customCursor.style.display = 'none';
            tenTasksCursor.style.display = 'block';
            
            // åˆå§‹åŒ–åä»»åŠ¡å¸ƒå±€
            initTenTasksLayout();
        }
        
        // ========== åˆå§‹åŒ–åä»»åŠ¡å¸ƒå±€ ==========
        function initTenTasksLayout() {
            // æ¸…ç©ºå®¹å™¨
            tenTasksContainer.innerHTML = '';
            tenTasksButtons = [];
            
            // å®šä¹‰ä»»åŠ¡åˆ—è¡¨
            const taskNames = [
                "æ”¶æ‹¾æˆ¿é—´",
                "æ‹¿å……ç”µçº¿", 
                "å†æ¬¡ç¡®è®¤ä»»åŠ¡è¦æ±‚",
                "é€‰æ‹©æŠ¥å‘Šä¸­ä½¿ç”¨çš„å›¾ç‰‡",
                "æ‰¾åˆ°æäº¤æŠ¥å‘Šçš„é‚®ç®±",
                "å›æ¶ˆæ¯",
                "æ€»ç»“ä¸åæ€",
                "æè¿°æŠ¥å‘Šç»†èŠ‚å†…å®¹",
                "æ„æ€æ€»ä½“æ¡†æ¶", // æ­£ç¡®ä»»åŠ¡
                "æ£€æŸ¥æŠ¥å‘Šæ ¼å¼"  // é¢å¤–å¹²æ‰°ä»»åŠ¡
            ];
            
            // éšæœºé€‰æ‹©æ­£ç¡®ä»»åŠ¡çš„ä½ç½®ï¼ˆ0-8ï¼Œå› ä¸ºæ„æ€æ€»ä½“æ¡†æ¶æ˜¯æ­£ç¡®ä»»åŠ¡ï¼‰
            correctTaskIndex = 8; // å›ºå®š"æ„æ€æ€»ä½“æ¡†æ¶"ä¸ºæ­£ç¡®ä»»åŠ¡
            
            // è·å–å®¹å™¨å°ºå¯¸
            const containerWidth = tenTasksContainer.offsetWidth;
            const containerHeight = tenTasksContainer.offsetHeight;
            
            // é¢„å®šä¹‰çš„ç½‘æ ¼ä½ç½®ï¼ˆç¡®ä¿æŒ‰é’®ä¸é‡å ï¼‰
            const gridPositions = [
                // ç¬¬ä¸€è¡Œ
                {x: 0.15, y: 0.15},
                {x: 0.35, y: 0.15},
                {x: 0.55, y: 0.15},
                {x: 0.75, y: 0.15},
                // ç¬¬äºŒè¡Œ
                {x: 0.15, y: 0.35},
                {x: 0.35, y: 0.35},
                {x: 0.55, y: 0.35},
                {x: 0.75, y: 0.35},
                // ç¬¬ä¸‰è¡Œ
                {x: 0.25, y: 0.65},
                {x: 0.50, y: 0.65}
            ];
            
            // æ‰“ä¹±ä½ç½®æ•°ç»„ï¼Œä½¿æŒ‰é’®éšæœºåˆ†å¸ƒ
            const shuffledPositions = [...gridPositions].sort(() => Math.random() - 0.5);
            
            // åˆ›å»º10ä¸ªä»»åŠ¡æŒ‰é’®
            for (let i = 0; i < 10; i++) {
                const isCorrect = i === correctTaskIndex;
                
                // åˆ›å»ºæŒ‰é’®å®¹å™¨
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'scattered-task-btn-container';
                buttonContainer.style.position = 'absolute';
                
                // ä½¿ç”¨é¢„å®šä¹‰çš„ä½ç½®
                const position = shuffledPositions[i];
                
                // è®¡ç®—åƒç´ ä½ç½®
                const finalX = Math.max(60, Math.min(containerWidth - 60, position.x * containerWidth));
                const finalY = Math.max(60, Math.min(containerHeight - 60, position.y * containerHeight));
                
                buttonContainer.style.left = `${finalX}px`;
                buttonContainer.style.top = `${finalY}px`;
                buttonContainer.style.transform = 'translate(-50%, -50%)';
                
                // åˆ›å»ºå¸å¼•åŠ›å…‰ç¯ï¼ˆåªå¯¹å¹²æ‰°ä»»åŠ¡æ·»åŠ çº¢è‰²å¸å¼•åŠ›å…‰ç¯ï¼‰
                if (!isCorrect) {
                    const attractionEffect = document.createElement('div');
                    attractionEffect.className = 'attraction-effect';
                    attractionEffect.style.left = '50%';
                    attractionEffect.style.top = '50%';
                    attractionEffect.style.transform = 'translate(-50%, -50%)';
                    attractionEffect.style.background = 'radial-gradient(circle at center, rgba(255, 100, 100, 0.5) 0%, rgba(255, 100, 100, 0.3) 40%, transparent 70%)';
                    buttonContainer.appendChild(attractionEffect);
                }
                
                // åˆ›å»ºä»»åŠ¡æŒ‰é’®ï¼ˆæ‰€æœ‰æŒ‰é’®éƒ½æ˜¯ç°è‰²ï¼‰
                const taskButton = document.createElement('button');
                taskButton.className = 'scattered-task-btn';
                taskButton.id = `scatteredTaskBtn${i}`;
                
                const buttonText = document.createElement('div');
                buttonText.className = 'scattered-task-btn-text';
                
                const title = document.createElement('div');
                title.className = 'scattered-task-btn-title';
                title.textContent = taskNames[i];
                
                buttonText.appendChild(title);
                taskButton.appendChild(buttonText);
                buttonContainer.appendChild(taskButton);
                
                // æ·»åŠ åˆ°å®¹å™¨
                tenTasksContainer.appendChild(buttonContainer);
                
                // å­˜å‚¨æŒ‰é’®ä¿¡æ¯
                const buttonInfo = {
                    element: taskButton,
                    container: buttonContainer,
                    isCorrect: isCorrect,
                    x: finalX,
                    y: finalY,
                    name: taskNames[i]
                };
                
                tenTasksButtons.push(buttonInfo);
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶ - é˜²æ­¢æŒ‰é’®ç‚¹å‡»æ—¶æ”¹å˜ç„¦ç‚¹
                taskButton.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    handleTenTaskClick(i);
                });
                
                taskButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    handleTenTaskClick(i);
                });
                
                // ä¸ºå¹²æ‰°ä»»åŠ¡æ·»åŠ é¼ æ ‡å¸å¼•åŠ›æ•ˆæœ
                if (!isCorrect) {
                    // ä¸ºå¹²æ‰°ä»»åŠ¡æ·»åŠ å¸å¼•åŠ›å…‰ç¯
                    const attractionEffect = document.querySelector('.attraction-effect');
                    if (attractionEffect) {
                        taskButton.addEventListener('mouseenter', () => {
                            // å½“é¼ æ ‡è¿›å…¥å¹²æ‰°ä»»åŠ¡æ—¶ï¼Œå¢å¼ºå¸å¼•åŠ›æ•ˆæœ
                            attractionEffect.style.animation = 'attraction-pulse 0.5s infinite alternate';
                        });
                        
                        taskButton.addEventListener('mouseleave', () => {
                            // é¼ æ ‡ç¦»å¼€æ—¶æ¢å¤
                            attractionEffect.style.animation = 'attraction-pulse 1s infinite alternate';
                        });
                    }
                }
            }
            
            // å¼€å§‹è®¡æ—¶
            tenTasksStartTime = Date.now();
            if (tenTasksTimerInterval) clearInterval(tenTasksTimerInterval);
            tenTasksTimerInterval = setInterval(() => {
                tenTasksAttemptTimer = (Date.now() - tenTasksStartTime) / 1000;
                tenTasksTimer.textContent = `æ—¶é—´: ${tenTasksAttemptTimer.toFixed(1)}ç§’`;
                
                // æ›´æ–°çº¢è‰²åœ†ç‚¹å…‰æ ‡ä½ç½®
                tenTasksCursor.style.left = `${mousePos.x - 7.5}px`;
                tenTasksCursor.style.top = `${mousePos.y - 7.5}px`;
                
                // æ£€æŸ¥é¼ æ ‡æ˜¯å¦åœ¨å¹²æ‰°ä»»åŠ¡é™„è¿‘ï¼Œæ’­æ”¾å¸å¼•åŠ›å—¡é¸£å£°
                checkAndPlayAttractionSound();
            }, 100);
            
            // å¼€å§‹é¼ æ ‡è·³è·ƒï¼ˆ1ç§’é—´éš”ï¼‰
            startMouseJumping();
            
            // åˆå§‹åŒ–é¼ æ ‡ä½ç½®åœ¨ç¬¬ä¸€ä¸ªå¹²æ‰°ä»»åŠ¡ä¸Š
            const firstDistractionButton = tenTasksButtons.find(btn => !btn.isCorrect);
            if (firstDistractionButton) {
                mousePos.x = firstDistractionButton.container.offsetLeft + firstDistractionButton.container.offsetWidth / 2;
                mousePos.y = firstDistractionButton.container.offsetTop + firstDistractionButton.container.offsetHeight / 2;
            }
        }
        
        // ========== æ£€æŸ¥å¹¶æ’­æ”¾å¸å¼•åŠ›å—¡é¸£å£° ==========
        function checkAndPlayAttractionSound() {
            if (!isAudioEnabled || !audioContext) return;
            
            // æ£€æŸ¥é¼ æ ‡æ˜¯å¦åœ¨å¹²æ‰°ä»»åŠ¡é™„è¿‘ï¼ˆ150pxèŒƒå›´å†…ï¼‰
            let isNearDistraction = false;
            let nearestDistance = Infinity;
            
            tenTasksButtons.forEach(buttonInfo => {
                if (!buttonInfo.isCorrect) {
                    const distance = Math.hypot(
                        mousePos.x - (buttonInfo.x),
                        mousePos.y - (buttonInfo.y)
                    );
                    
                    if (distance < 150) {
                        isNearDistraction = true;
                        nearestDistance = Math.min(nearestDistance, distance);
                    }
                }
            });
            
            // å¦‚æœé¼ æ ‡åœ¨å¹²æ‰°ä»»åŠ¡é™„è¿‘ï¼Œæ’­æ”¾å¸å¼•åŠ›å—¡é¸£å£°
            if (isNearDistraction && !isAttractionSoundPlaying) {
                playAttractionSound(nearestDistance);
            } else if (!isNearDistraction && isAttractionSoundPlaying) {
                stopAttractionSound();
            } else if (isNearDistraction && isAttractionSoundPlaying) {
                // æ›´æ–°å£°éŸ³é¢‘ç‡å’ŒéŸ³é‡
                updateAttractionSound(nearestDistance);
            }
        }
        
        // ========== æ’­æ”¾å¸å¼•åŠ›å—¡é¸£å£° ==========
        function playAttractionSound(distance) {
            if (!isAudioEnabled || !audioContext) return;
            
            // åˆ›å»ºå—¡é¸£å£°æŒ¯è¡å™¨
            attractionSoundOscillator = audioContext.createOscillator();
            attractionSoundGain = audioContext.createGain();
            
            // è®¡ç®—å£°éŸ³å‚æ•°ï¼ˆè·ç¦»è¶Šè¿‘ï¼Œå£°éŸ³è¶Šå¤§ã€é¢‘ç‡è¶Šé«˜ï¼‰
            const intensity = Math.max(0, 1 - (distance / 150)); // 0-1ä¹‹é—´
            const frequency = 100 + (intensity * 200); // 100-300Hz
            const volume = 0.1 + (intensity * 0.2); // 0.1-0.3éŸ³é‡
            
            attractionSoundOscillator.type = 'sawtooth';
            attractionSoundOscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            
            attractionSoundGain.gain.setValueAtTime(volume, audioContext.currentTime);
            
            attractionSoundOscillator.connect(attractionSoundGain);
            attractionSoundGain.connect(audioContext.destination);
            
            attractionSoundOscillator.start();
            isAttractionSoundPlaying = true;
        }
        
        // ========== åœæ­¢å¸å¼•åŠ›å—¡é¸£å£° ==========
        function stopAttractionSound() {
            if (!isAttractionSoundPlaying || !attractionSoundOscillator) return;
            
            // æ·¡å‡ºå£°éŸ³
            attractionSoundGain.gain.exponentialRampToValueAtTime(
                0.001, 
                audioContext.currentTime + 0.3
            );
            
            setTimeout(() => {
                if (attractionSoundOscillator) {
                    attractionSoundOscillator.stop();
                    attractionSoundOscillator.disconnect();
                    attractionSoundOscillator = null;
                    attractionSoundGain = null;
                    isAttractionSoundPlaying = false;
                }
            }, 300);
        }
        
        // ========== æ›´æ–°å¸å¼•åŠ›å—¡é¸£å£° ==========
        function updateAttractionSound(distance) {
            if (!isAttractionSoundPlaying || !attractionSoundOscillator || !attractionSoundGain) return;
            
            const intensity = Math.max(0, 1 - (distance / 150));
            const frequency = 100 + (intensity * 200);
            const volume = 0.1 + (intensity * 0.2);
            
            attractionSoundOscillator.frequency.linearRampToValueAtTime(
                frequency, 
                audioContext.currentTime + 0.1
            );
            
            attractionSoundGain.gain.linearRampToValueAtTime(
                volume, 
                audioContext.currentTime + 0.1
            );
        }
        
        // ========== å¼€å§‹é¼ æ ‡è·³è·ƒ ==========
        function startMouseJumping() {
            if (tenTasksMouseJumpInterval) clearInterval(tenTasksMouseJumpInterval);
            
            tenTasksMouseJumpInterval = setInterval(() => {
                // éšæœºé€‰æ‹©ä¸€ä¸ªå¹²æ‰°ä»»åŠ¡
                const distractionButtons = tenTasksButtons.filter(btn => !btn.isCorrect);
                if (distractionButtons.length > 0) {
                    const randomButton = distractionButtons[Math.floor(Math.random() * distractionButtons.length)];
                    
                    // åˆ›å»ºè·³è·ƒæŒ‡ç¤ºå™¨
                    const jumpIndicator = document.createElement('div');
                    jumpIndicator.className = 'mouse-jump-indicator';
                    jumpIndicator.style.left = `${randomButton.container.offsetLeft + randomButton.container.offsetWidth / 2 - 15}px`;
                    jumpIndicator.style.top = `${randomButton.container.offsetTop + randomButton.container.offsetHeight / 2 - 15}px`;
                    tenTasksContainer.appendChild(jumpIndicator);
                    
                    // ç§»é™¤æŒ‡ç¤ºå™¨
                    setTimeout(() => {
                        if (jumpIndicator.parentNode) {
                            jumpIndicator.parentNode.removeChild(jumpIndicator);
                        }
                    }, 500);
                    
                    // è·³è·ƒåˆ°è¯¥æŒ‰é’®ä½ç½®
                    mousePos.x = randomButton.container.offsetLeft + randomButton.container.offsetWidth / 2;
                    mousePos.y = randomButton.container.offsetTop + randomButton.container.offsetHeight / 2;
                    
                    // æ’­æ”¾è·³è·ƒéŸ³æ•ˆ
                    if (isAudioEnabled && audioContext) {
                        const jumpSound = audioContext.createOscillator();
                        const jumpGain = audioContext.createGain();
                        
                        jumpSound.type = 'sine';
                        jumpSound.frequency.setValueAtTime(300, audioContext.currentTime);
                        jumpSound.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.2);
                        
                        jumpGain.gain.setValueAtTime(0.1, audioContext.currentTime);
                        jumpGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                        
                        jumpSound.connect(jumpGain);
                        jumpGain.connect(audioContext.destination);
                        
                        jumpSound.start();
                        jumpSound.stop(audioContext.currentTime + 0.2);
                    }
                    
                    mouseJumpCount++;
                }
            }, 1000); // æ”¹ä¸º1ç§’è·³è·ƒä¸€æ¬¡
        }
        
        // ========== å¤„ç†åä»»åŠ¡ç‚¹å‡» ==========
        function handleTenTaskClick(buttonIndex) {
            const buttonInfo = tenTasksButtons[buttonIndex];
            
            if (buttonInfo.isCorrect) {
                // ç‚¹å‡»æ­£ç¡®æŒ‰é’® - è·³è½¬åˆ°æˆåŠŸç•Œé¢
                clearInterval(tenTasksTimerInterval);
                clearInterval(tenTasksMouseJumpInterval);
                stopAttractionSound();
                
                // æ’­æ”¾æˆåŠŸéŸ³æ•ˆ
                if (isAudioEnabled && audioContext) {
                    const successOscillator = audioContext.createOscillator();
                    const successGain = audioContext.createGain();
                    
                    successOscillator.type = 'sine';
                    successOscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                    successOscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                    successOscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
                    
                    successGain.gain.setValueAtTime(0, audioContext.currentTime);
                    successGain.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                    successGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    successOscillator.connect(successGain);
                    successGain.connect(audioContext.destination);
                    
                    successOscillator.start();
                    successOscillator.stop(audioContext.currentTime + 0.5);
                }
                
                // éšè—åä»»åŠ¡ç•Œé¢
                tenTasksScreen.style.display = 'none';
                
                // æ˜¾ç¤ºæˆåŠŸç•Œé¢
                successScreen.style.display = 'flex';
                
                // æ›´æ–°æˆåŠŸç•Œé¢çš„ç»Ÿè®¡æ•°æ®
                finalTime.textContent = `${(attemptTimer + tenTasksAttemptTimer).toFixed(1)}s`;
                finalStableTime.textContent = `${timeNearButton.toFixed(1)}s`;
                finalFails.textContent = failCount;
                finalEnergy.textContent = `${Math.round(energy)}%`;
                
                // åˆ›å»ºåº†ç¥åŠ¨ç”»
                createCelebrationAnimation();
                
            } else {
                // ç‚¹å‡»å¹²æ‰°æŒ‰é’® - åªæ’­æ”¾è½»å¾®éŸ³æ•ˆï¼Œä¸æ˜¾ç¤ºé”™è¯¯æç¤º
                if (isAudioEnabled && audioContext) {
                    const clickSound = audioContext.createOscillator();
                    const clickGain = audioContext.createGain();
                    
                    clickSound.type = 'sine';
                    clickSound.frequency.setValueAtTime(150, audioContext.currentTime);
                    clickSound.frequency.exponentialRampToValueAtTime(80, audioContext.currentTime + 0.2);
                    
                    clickGain.gain.setValueAtTime(0.05, audioContext.currentTime);
                    clickGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    
                    clickSound.connect(clickGain);
                    clickGain.connect(audioContext.destination);
                    
                    clickSound.start();
                    clickSound.stop(audioContext.currentTime + 0.2);
                }
                
                // ä¸æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œä¿æŒå®‰é™
            }
        }
        
        // ========== æ˜¾ç¤ºæˆåŠŸç•Œé¢ ==========
        function showSuccessScreen() {
            isFrozen = true;
            stopCurrentSound();
            stopTimer();
            stopCenterHoldDetection();
            stopAttractionSound();
            
            // è§£é”é¼ æ ‡
            document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock;
            document.exitPointerLock();
            
            // éšè—æ‰€æœ‰ç¬¬ä¸€ç•Œé¢çš„å…ƒç´ 
            document.querySelectorAll('.gravity-well, .entertainment-zones, .energy-bar, .energy-value, .timer-display, .resistance-indicator, .find-button-hint, .distraction-timer, .button-instruction, .audio-control, .custom-cursor, .lock-hint, .audio-hint, .center-hint, .fail-count-display, .ten-tasks-cursor').forEach(el => {
                el.style.display = 'none';
            });
            
            // éšè—åä»»åŠ¡ç•Œé¢
            tenTasksScreen.style.display = 'none';
            
            // è®¡ç®—å®é™…åœ¨æŒ‰é’®é™„è¿‘çš„æ—¶é—´
            const actualTimeNearButton = timeNearButton;
            
            // æ›´æ–°æˆåŠŸç•Œé¢çš„ç»Ÿè®¡æ•°æ®
            finalTime.textContent = `${attemptTimer.toFixed(1)}s`;
            finalStableTime.textContent = `${actualTimeNearButton.toFixed(1)}s`;
            finalFails.textContent = failCount;
            finalEnergy.textContent = `${Math.round(energy)}%`;
            
            // åˆ›å»ºåº†ç¥åŠ¨ç”»
            createCelebrationAnimation();
            
            // æ˜¾ç¤ºæˆåŠŸç•Œé¢
            successScreen.style.display = 'flex';
            
            // æ’­æ”¾åº†ç¥éŸ³ä¹
            if (isAudioEnabled && audioContext) {
                playCelebrationMusic();
            }
        }
        
        // ========== åˆ›å»ºåº†ç¥åŠ¨ç”» ==========
        function createCelebrationAnimation() {
            // æ¸…é™¤ç°æœ‰åŠ¨ç”»
            celebrationAnimation.innerHTML = '';
            
            // åˆ›å»ºå½©çº¸æ•ˆæœ
            const colors = ['#FF5252', '#FF4081', '#E040FB', '#7C4DFF', '#536DFE', '#448AFF', '#40C4FF', '#18FFFF', '#64FFDA', '#69F0AE', '#B2FF59', '#EEFF41', '#FFFF00', '#FFD740', '#FFAB40', '#FF6E40'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                // éšæœºé¢œè‰²
                const color = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.background = color;
                
                // éšæœºä½ç½®
                confetti.style.left = `${Math.random() * 100}%`;
                
                // éšæœºå¤§å°
                const size = 5 + Math.random() * 15;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size * 2}px`;
                
                // éšæœºåŠ¨ç”»å»¶è¿Ÿå’ŒæŒç»­æ—¶é—´
                const delay = Math.random() * 3;
                const duration = 3 + Math.random() * 4;
                confetti.style.animationDelay = `${delay}s`;
                confetti.style.animationDuration = `${duration}s`;
                
                celebrationAnimation.appendChild(confetti);
            }
        }
        
        // ========== æ’­æ”¾åº†ç¥éŸ³ä¹ ==========
        function playCelebrationMusic() {
            if (!isAudioEnabled || !audioContext) return;
            
            // åˆ›å»ºåº†ç¥å’Œå¼¦
            const frequencies = [261.63, 329.63, 392.00, 523.25]; // C, E, G, C (é«˜)
            
            frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                
                gain.gain.setValueAtTime(0, audioContext.currentTime);
                gain.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1 + (index * 0.05));
                gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 2 + (index * 0.1));
                
                oscillator.connect(gain);
                gain.connect(audioContext.destination);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 2.5);
            });
        }
        
        // ========== ç»§ç»­æŒ‰é’®äº‹ä»¶ ==========
        continueBtn.addEventListener('click', () => {
            // è·³è½¬åˆ°åä»»åŠ¡åˆ†æ•£å¸ƒå±€
            successScreen.style.display = 'none';
            showTenTasksScreen();
        });
        
        // ========== è¿”å›å¼€å§‹æŒ‰é’®äº‹ä»¶ ==========
        backToStart.addEventListener('click', () => {
            location.reload();
        });
        
        // ========== åä»»åŠ¡è¿”å›æŒ‰é’®äº‹ä»¶ ==========
        tenTasksBackBtn.addEventListener('click', () => {
            // åœæ­¢åä»»åŠ¡è®¡æ—¶å™¨å’Œè·³è·ƒ
            clearInterval(tenTasksTimerInterval);
            clearInterval(tenTasksMouseJumpInterval);
            stopAttractionSound();
            
            // éšè—åä»»åŠ¡ç•Œé¢
            tenTasksScreen.style.display = 'none';
            
            // é‡æ–°åŠ è½½é¡µé¢
            location.reload();
        });

        // ========== èƒ½é‡æ¡é€»è¾‘ ==========
        function reduceEnergy(amount) {
            energy = Math.max(0, energy - amount);
            energyFill.style.width = `${energy}%`;
            energyValue.textContent = `${Math.round(energy)}%`;
            
            // æ ¹æ®èƒ½é‡å€¼æ”¹å˜é¢œè‰²
            if (energy < 20) {
                energyValue.style.color = '#F44336';
                energyValue.style.fontWeight = 'bold';
            } else if (energy < 50) {
                energyValue.style.color = '#FF9800';
                energyValue.style.fontWeight = 'normal';
            } else {
                energyValue.style.color = '#333';
                energyValue.style.fontWeight = 'normal';
            }
        }

        function restoreEnergy(amount) {
            energy = Math.min(100, energy + amount);
            energyFill.style.width = `${energy}%`;
            energyValue.textContent = `${Math.round(energy)}%`;
            
            // æ ¹æ®èƒ½é‡å€¼æ”¹å˜é¢œè‰²
            if (energy < 20) {
                energyValue.style.color = '#F44336';
                energyValue.style.fontWeight = 'bold';
            } else if (energy < 50) {
                energyValue.style.color = '#FF9800';
                energyValue.style.fontWeight = 'normal';
            } else {
                energyValue.style.color = '#333';
                energyValue.style.fontWeight = 'normal';
            }
        }

        // ========== è§¦å‘è¯Šæ–­å›¾å±‚ ==========
        function triggerDiagnosisOverlay() {
            isFrozen = true;
            stopCurrentSound();
            stopTimer();
            stopCenterHoldDetection();
            stopAttractionSound();
            diagnosisOverlay.style.display = 'flex';
            // éšè—ä¸­é—´æç¤º - åœ¨è¯Šæ–­é¡µé¢æ˜¾ç¤ºæ—¶éšè—é”å±æç¤º
            lockHint.style.display = 'none'; // ä½¿ç”¨display:noneè€Œä¸æ˜¯æ·»åŠ hiddenç±»
            // è§£é”é¼ æ ‡
            document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock;
            document.exitPointerLock();
            
            // éšè—å…¶ä»–UIå…ƒç´ 
            document.querySelectorAll('.gravity-well, .entertainment-zones, .energy-bar, .energy-value, .timer-display, .resistance-indicator, .find-button-hint, .distraction-timer, .button-instruction, .audio-control, .custom-cursor, .lock-hint, .audio-hint, .center-hint, .fail-count-display, .ten-tasks-cursor').forEach(el => {
                el.style.display = 'none';
            });
            
            // éšè—åä»»åŠ¡ç•Œé¢
            tenTasksScreen.style.display = 'none';
            
            // æ³¨æ„ï¼šå·²åˆ é™¤"æœ¬æ¬¡ä½“éªŒå¤±è´¥æ¬¡æ•°ï¼šâ€¦â€¦"è¿™æ®µè¯ï¼Œè¯Šæ–­é¡µé¢åªæ˜¾ç¤ºåŸå§‹å†…å®¹
        }

        // å…³é—­è¯Šæ–­å›¾å±‚
        diagnosisOverlay.addEventListener('click', () => {
            diagnosisOverlay.style.display = 'none';
            // é‡æ–°æ˜¾ç¤ºé”å±æç¤º
            lockHint.style.display = 'block'; // é‡æ–°æ˜¾ç¤ºé”å±æç¤º
            lockHint.classList.remove('hidden');
            location.reload();
        });

        // ========== åˆå§‹åŒ–å…‰æ ‡ä½ç½® ==========
        function updateCursorPosition(e) {
            if (!isLocked && tenTasksScreen.style.display !== 'flex') {
                mousePos.x = e.clientX;
                mousePos.y = e.clientY;
                customCursor.style.left = `${mousePos.x - 10}px`;
                customCursor.style.top = `${mousePos.y - 10}px`;
            } else if (tenTasksScreen.style.display === 'flex') {
                // åœ¨åä»»åŠ¡ç•Œé¢ä¸­ç§»åŠ¨é¼ æ ‡
                mousePos.x = e.clientX;
                mousePos.y = e.clientY;
                tenTasksCursor.style.left = `${mousePos.x - 7.5}px`;
                tenTasksCursor.style.top = `${mousePos.y - 7.5}px`;
            }
        }
        
        // ç›‘å¬é¼ æ ‡ç§»åŠ¨ï¼Œæ›´æ–°å…‰æ ‡ä½ç½®
        document.addEventListener('mousemove', updateCursorPosition);
        
        // é¡µé¢å…³é—­æ—¶æ¸…ç†éŸ³é¢‘èµ„æº
        window.addEventListener('beforeunload', () => {
            if (audioContext) {
                audioContext.close();
            }
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            if (distractionTimerInterval) {
                clearInterval(distractionTimerInterval);
            }
            if (centerHoldInterval) {
                clearInterval(centerHoldInterval);
            }
            if (tenTasksTimerInterval) {
                clearInterval(tenTasksTimerInterval);
            }
            if (tenTasksMouseJumpInterval) {
                clearInterval(tenTasksMouseJumpInterval);
            }
            stopAttractionSound();
        });
        
        // çª—å£è°ƒæ•´å¤§å°æ—¶é‡æ–°è®¡ç®—ä½ç½®
        window.addEventListener('resize', () => {
            const newRect = gravityWell.getBoundingClientRect();
            gravityWellCenter.x = newRect.left + newRect.width / 2;
            gravityWellCenter.y = newRect.top + newRect.height / 2;
            
            const newZone1Rect = zone1.getBoundingClientRect();
            const newZone2Rect = zone2.getBoundingClientRect();
            zone1Center.x = newZone1Rect.left + newZone1Rect.width / 2;
            zone1Center.y = newZone1Rect.top + newZone1Rect.height / 2;
            zone2Center.x = newZone2Rect.left + newZone2Rect.width / 2;
            zone2Center.y = newZone2Rect.top + newZone2Rect.height / 2;
            
            // å¦‚æœåä»»åŠ¡ç•Œé¢æ­£åœ¨æ˜¾ç¤ºï¼Œé‡æ–°è®¡ç®—æŒ‰é’®ä½ç½®
            if (tenTasksScreen.style.display === 'flex') {
                initTenTasksLayout();
            }
        });
        
        // æ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬å™¨ï¼Œé˜²æ­¢æŸäº›é”®ç›˜æ“ä½œå¯¼è‡´ç„¦ç‚¹å˜åŒ–
        document.addEventListener('keydown', (e) => {
            if (tenTasksScreen.style.display === 'flex') {
                e.preventDefault();
                e.stopPropagation();
            }
        });
    </script>
</body>
</html>